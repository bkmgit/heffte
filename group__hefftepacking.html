<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Highly Efficient FFT for Exascale: HeFFTe v2.3: Packing/Unpacking operations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="heffte.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Highly Efficient FFT for Exascale: HeFFTe v2.3
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__hefftepacking.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Packing/Unpacking operations<div class="ingroups"><a class="el" href="group__fft3d.html">Fast Fourier Transform</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Packing/Unpacking operations:</div>
<div class="dyncontent">
<div class="center"><img src="group__hefftepacking.png" border="0" usemap="#agroup____hefftepacking" alt=""/></div>
<map name="agroup____hefftepacking" id="agroup____hefftepacking">
<area shape="rect" title=" " alt="" coords="208,5,407,31"/>
<area shape="rect" href="group__fft3d.html" title=" " alt="" coords="5,5,160,31"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structheffte_1_1direct__packer_3_01tag_1_1gpu_01_4.html">heffte::direct_packer&lt; tag::gpu &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simple packer that copies sub-boxes without transposing the order of the indexes.  <a href="structheffte_1_1direct__packer_3_01tag_1_1gpu_01_4.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structheffte_1_1transpose__packer_3_01tag_1_1gpu_01_4.html">heffte::transpose_packer&lt; tag::gpu &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">GPU version of the transpose packer.  <a href="structheffte_1_1transpose__packer_3_01tag_1_1gpu_01_4.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structheffte_1_1pack__plan__3d.html">heffte::pack_plan_3d&lt; index &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds the plan for a pack/unpack operation.  <a href="structheffte_1_1pack__plan__3d.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structheffte_1_1packer__backend.html">heffte::packer_backend&lt; backend &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The packer needs to know whether the data will be on the CPU or GPU devices.  <a href="structheffte_1_1packer__backend.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structheffte_1_1direct__packer.html">heffte::direct_packer&lt; mode &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the direct packer without implementation, use the specializations to get the CPU or GPU implementation.  <a href="structheffte_1_1direct__packer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structheffte_1_1direct__packer_3_01tag_1_1cpu_01_4.html">heffte::direct_packer&lt; tag::cpu &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simple packer that copies sub-boxes without transposing the order of the indexes.  <a href="structheffte_1_1direct__packer_3_01tag_1_1cpu_01_4.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structheffte_1_1transpose__packer.html">heffte::transpose_packer&lt; mode &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the transpose packer without implementation, use the specializations to get the CPU implementation.  <a href="structheffte_1_1transpose__packer.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structheffte_1_1transpose__packer_3_01tag_1_1cpu_01_4.html">heffte::transpose_packer&lt; tag::cpu &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transpose packer that packs sub-boxes without transposing, but unpacks applying a transpose operation.  <a href="structheffte_1_1transpose__packer_3_01tag_1_1cpu_01_4.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga8c1eb8a77974f4fb009cbb01c4a4cfec"><td class="memTemplParams" colspan="2"><a id="ga8c1eb8a77974f4fb009cbb01c4a4cfec"></a>
template&lt;typename index &gt; </td></tr>
<tr class="memitem:ga8c1eb8a77974f4fb009cbb01c4a4cfec"><td class="memTemplItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__hefftepacking.html#ga8c1eb8a77974f4fb009cbb01c4a4cfec">heffte::operator&lt;&lt;</a> (std::ostream &amp;os, <a class="el" href="structheffte_1_1pack__plan__3d.html">pack_plan_3d</a>&lt; index &gt; const &amp;plan)</td></tr>
<tr class="memdesc:ga8c1eb8a77974f4fb009cbb01c4a4cfec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes a plan to the stream, useful for debugging. <br /></td></tr>
<tr class="separator:ga8c1eb8a77974f4fb009cbb01c4a4cfec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6f6781b7e171caa8fc953e081cc08ec1"><td class="memTemplParams" colspan="2"><a id="ga6f6781b7e171caa8fc953e081cc08ec1"></a>
template&lt;typename scalar_type , typename index &gt; </td></tr>
<tr class="memitem:ga6f6781b7e171caa8fc953e081cc08ec1"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__hefftepacking.html#ga6f6781b7e171caa8fc953e081cc08ec1">heffte::data_scaling::apply</a> (void *, index num_entries, scalar_type *data, double scale_factor)</td></tr>
<tr class="memdesc:ga6f6781b7e171caa8fc953e081cc08ec1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simply multiply the <b>num_entries</b> in the <b>data</b> by the <b>scale_factor</b>. <br /></td></tr>
<tr class="separator:ga6f6781b7e171caa8fc953e081cc08ec1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4415293bbb8355a0562759a4243abd6a"><td class="memTemplParams" colspan="2">template&lt;typename precision_type , typename index &gt; </td></tr>
<tr class="memitem:ga4415293bbb8355a0562759a4243abd6a"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__hefftepacking.html#ga4415293bbb8355a0562759a4243abd6a">heffte::data_scaling::apply</a> (void *stream, index num_entries, std::complex&lt; precision_type &gt; *data, double scale_factor)</td></tr>
<tr class="memdesc:ga4415293bbb8355a0562759a4243abd6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Complex by real scaling.  <a href="group__hefftepacking.html#ga4415293bbb8355a0562759a4243abd6a">More...</a><br /></td></tr>
<tr class="separator:ga4415293bbb8355a0562759a4243abd6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga71c3b5076dd233fa9384ecb48de7ad81"><td class="memTemplParams" colspan="2"><a id="ga71c3b5076dd233fa9384ecb48de7ad81"></a>
template&lt;typename scalar_type , typename index &gt; </td></tr>
<tr class="memitem:ga71c3b5076dd233fa9384ecb48de7ad81"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__hefftepacking.html#ga71c3b5076dd233fa9384ecb48de7ad81">heffte::data_scaling::apply</a> (index num_entries, scalar_type *data, double scale_factor)</td></tr>
<tr class="memdesc:ga71c3b5076dd233fa9384ecb48de7ad81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper method that omits the stream for the CPU case. <br /></td></tr>
<tr class="separator:ga71c3b5076dd233fa9384ecb48de7ad81"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>MPI communications assume that the data is located in contiguous arrays; however, the blocks that need to be transmitted in an FFT algorithm correspond to sub-boxes of a three dimensional array, which is never contiguous. Thus, packing and unpacking operations are needed to copy the sub-box into contiguous arrays. Furthermore, some backends (e.g., fftw3) work much faster with contiguous FFT transforms, thus it is beneficial to transpose the data between backend calls. Combining unpack and transpose operations reduces data movement. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga4415293bbb8355a0562759a4243abd6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4415293bbb8355a0562759a4243abd6a">&#9670;&nbsp;</a></span>apply()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename precision_type , typename index &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void heffte::data_scaling::apply </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>stream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">index&#160;</td>
          <td class="paramname"><em>num_entries</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::complex&lt; precision_type &gt; *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scale_factor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Complex by real scaling. </p>
<p>Depending on the compiler and type of operation, C++ complex numbers can have bad performance compared to float and double operations. Since the scaling factor is always real, scaling can be performed with real arithmetic which is easier to vectorize. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
