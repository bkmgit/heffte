<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Highly Efficient FFT for Exascale: HeFFTe v2.3: include/heffte_fft3d.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="heffte.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Highly Efficient FFT for Exascale: HeFFTe v2.3
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('heffte__fft3d_8h_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">heffte_fft3d.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">    -- heFFTe --</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">       Univ. of Tennessee, Knoxville</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">       @date</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160; </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#ifndef HEFFTE_FFT3D_H</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#define HEFFTE_FFT3D_H</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;heffte_compute_transform.h&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceheffte.html">heffte</a> {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="structheffte_1_1fft__output.html">   58</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> scalar_type&gt; <span class="keyword">struct </span><a class="code" href="structheffte_1_1fft__output.html">fft_output</a>{</div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="structheffte_1_1fft__output.html#a6fa9044617b21efd39ef2ee93dde6d94">   60</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structheffte_1_1fft__output.html#a6fa9044617b21efd39ef2ee93dde6d94">type</a> = scalar_type;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;};</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="structheffte_1_1fft__output_3_01float_01_4.html">   66</a></span>&#160;<span class="keyword">template</span>&lt;&gt; <span class="keyword">struct </span><a class="code" href="structheffte_1_1fft__output.html">fft_output</a>&lt;float&gt;{</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="structheffte_1_1fft__output_3_01float_01_4.html#a17f0c7d62bb0347315048ffd73bad5c0">   68</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structheffte_1_1fft__output_3_01float_01_4.html#a17f0c7d62bb0347315048ffd73bad5c0">type</a> = std::complex&lt;float&gt;;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;};</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="structheffte_1_1fft__output_3_01double_01_4.html">   74</a></span>&#160;<span class="keyword">template</span>&lt;&gt; <span class="keyword">struct </span><a class="code" href="structheffte_1_1fft__output.html">fft_output</a>&lt;double&gt;{</div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="structheffte_1_1fft__output_3_01double_01_4.html#afc4e0ad32ebd79081386c433791d6c00">   76</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structheffte_1_1fft__output_3_01double_01_4.html#afc4e0ad32ebd79081386c433791d6c00">type</a> = std::complex&lt;double&gt;;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;};</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> scalar_type, <span class="keyword">typename</span> backend_tag, <span class="keyword">typename</span> = <span class="keywordtype">void</span>&gt;</div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="structheffte_1_1transform__output.html">   86</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structheffte_1_1transform__output.html">transform_output</a>{};</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> scalar_type, <span class="keyword">typename</span> backend_tag&gt;</div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="structheffte_1_1transform__output_3_01scalar__type_00_01backend__tag_00_01typename_01std_1_1enab68ec9eb0046c8bf0dddff44974913856.html">   92</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structheffte_1_1transform__output.html">transform_output</a>&lt;scalar_type, backend_tag, typename std::enable_if&lt;backend::uses_fft_types&lt;backend_tag&gt;::value&gt;<a class="code" href="structheffte_1_1transform__output_3_01scalar__type_00_01backend__tag_00_01typename_01std_1_1enab68ec9eb0046c8bf0dddff44974913856.html#af3e40642e49bcfc1ba180463a6b658b3">::type</a>&gt;{</div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="structheffte_1_1transform__output_3_01scalar__type_00_01backend__tag_00_01typename_01std_1_1enab68ec9eb0046c8bf0dddff44974913856.html#af3e40642e49bcfc1ba180463a6b658b3">   94</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structheffte_1_1transform__output_3_01scalar__type_00_01backend__tag_00_01typename_01std_1_1enab68ec9eb0046c8bf0dddff44974913856.html#af3e40642e49bcfc1ba180463a6b658b3">type</a> = <span class="keyword">typename</span> <a class="code" href="structheffte_1_1fft__output.html#a6fa9044617b21efd39ef2ee93dde6d94">fft_output&lt;scalar_type&gt;::type</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;};</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> scalar_type, <span class="keyword">typename</span> backend_tag&gt;</div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="structheffte_1_1transform__output_3_01scalar__type_00_01backend__tag_00_01typename_01std_1_1enab4657b516353cb2b2964ad38c40dce9ef.html">  101</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structheffte_1_1transform__output.html">transform_output</a>&lt;scalar_type, backend_tag, typename std::enable_if&lt;not backend::uses_fft_types&lt;backend_tag&gt;::value&gt;<a class="code" href="structheffte_1_1transform__output_3_01scalar__type_00_01backend__tag_00_01typename_01std_1_1enab4657b516353cb2b2964ad38c40dce9ef.html#a4a8cd13f8d1e7931e959c0a07d43d01e">::type</a>&gt;{</div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="structheffte_1_1transform__output_3_01scalar__type_00_01backend__tag_00_01typename_01std_1_1enab4657b516353cb2b2964ad38c40dce9ef.html#a4a8cd13f8d1e7931e959c0a07d43d01e">  103</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="structheffte_1_1transform__output_3_01scalar__type_00_01backend__tag_00_01typename_01std_1_1enab4657b516353cb2b2964ad38c40dce9ef.html#a4a8cd13f8d1e7931e959c0a07d43d01e">type</a> = scalar_type;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;};</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">  113</a></span>&#160;<span class="keyword">enum class</span> <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a>{</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">none</a>,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cbae9dc924f238fa6cc29465942875fe8f0">full</a>,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cbafeca3c730601be7fd57f1f0b668b4637">symmetric</a></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;};</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> backend_tag, <span class="keyword">typename</span> index = <span class="keywordtype">int</span>&gt;</div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html">  213</a></span>&#160;<span class="keyword">class </span><a class="code" href="classheffte_1_1fft3d.html">fft3d</a> : <span class="keyword">public</span> <a class="code" href="structheffte_1_1backend_1_1device__instance.html">backend::device_instance</a>&lt;typename backend::buffer_traits&lt;backend_tag&gt;::location&gt;{</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#ac5d40d64cf59b863e7478209996d6107">  216</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="classheffte_1_1fft3d.html#ac5d40d64cf59b863e7478209996d6107">backend_executor</a> = <span class="keyword">typename</span> <a class="code" href="structheffte_1_1one__dim__backend.html">one_dim_backend&lt;backend_tag&gt;::executor</a>;</div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#aeb62ee60533b362f133f21cdd1911bec">  224</a></span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">using</span> <a class="code" href="classheffte_1_1fft3d.html#aeb62ee60533b362f133f21cdd1911bec">buffer_container</a> = <span class="keyword">typename</span> <a class="code" href="structheffte_1_1backend_1_1buffer__traits.html">backend::buffer_traits&lt;backend_tag&gt;::template</a> container&lt;T&gt;;</div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#adb9b0e347c94f2bdb5376a19e3d878b6">  226</a></span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">using</span> <a class="code" href="classheffte_1_1fft3d.html#adb9b0e347c94f2bdb5376a19e3d878b6">real_buffer_container</a> = <a class="code" href="classheffte_1_1fft3d.html#aeb62ee60533b362f133f21cdd1911bec">buffer_container&lt;typename define_standard_type&lt;T&gt;::type::value_type</a>&gt;;</div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#a39f229cbf43a1e7eee55d762579e3a7e">  228</a></span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">using</span> <a class="code" href="classheffte_1_1fft3d.html#a39f229cbf43a1e7eee55d762579e3a7e">output_buffer_container</a> = <a class="code" href="classheffte_1_1fft3d.html#aeb62ee60533b362f133f21cdd1911bec">buffer_container&lt;typename transform_output&lt;T, backend_tag&gt;::type</a>&gt;;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#a3b9d2b3e80788752589804c64b9b4afc">  233</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="classheffte_1_1fft3d.html#a3b9d2b3e80788752589804c64b9b4afc">location_tag</a> = <span class="keyword">typename</span> <a class="code" href="structheffte_1_1tag_1_1cpu.html">backend::buffer_traits&lt;backend_tag&gt;::location</a>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#a1d337dece28dd2d2aa0e93af04f9763b">  243</a></span>&#160;    <a class="code" href="classheffte_1_1fft3d.html#a1d337dece28dd2d2aa0e93af04f9763b">fft3d</a>(<a class="code" href="structheffte_1_1box3d.html">box3d&lt;index&gt;</a> <span class="keyword">const</span> <a class="code" href="classheffte_1_1fft3d.html#a27524f300afc834cd2dddd25beaee4b8">inbox</a>, <a class="code" href="structheffte_1_1box3d.html">box3d&lt;index&gt;</a> <span class="keyword">const</span> <a class="code" href="classheffte_1_1fft3d.html#a42a94caa949610c56767f5e7987af8df">outbox</a>, MPI_Comm <span class="keyword">const</span> comm,</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;          <a class="code" href="structheffte_1_1plan__options.html">plan_options</a> <span class="keyword">const</span> options = default_options&lt;backend_tag&gt;()) :</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <a class="code" href="classheffte_1_1fft3d.html">fft3d</a>(<a class="code" href="group__fft3dplan.html#gadfe5ddda96e7aecb88edc7aeb07dbc91">plan_operations</a>(mpi::<a class="code" href="group__hefftempi.html#gacade914d344f3727d9e7d8dcfd13ed5a">gather_boxes</a>(<a class="code" href="classheffte_1_1fft3d.html#a27524f300afc834cd2dddd25beaee4b8">inbox</a>, <a class="code" href="classheffte_1_1fft3d.html#a42a94caa949610c56767f5e7987af8df">outbox</a>, comm), -1, <a class="code" href="group__fft3d.html#ga8c2c4b54da75fafbe68b3115d4390a66">set_options</a>&lt;backend_tag&gt;(options), mpi::<a class="code" href="group__hefftempi.html#ga5df7514ec8acb2b7bcc642892ed22f67">comm_rank</a>(comm)), comm){</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        static_assert(<a class="code" href="structheffte_1_1backend_1_1is__enabled.html">backend::is_enabled&lt;backend_tag&gt;::value</a>, <span class="stringliteral">&quot;The requested backend is invalid or has not been enabled.&quot;</span>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    }</div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#ab5794a91773074377e6e59ded8face53">  265</a></span>&#160;    <a class="code" href="classheffte_1_1fft3d.html#ab5794a91773074377e6e59ded8face53">fft3d</a>(<span class="keyword">typename</span> <a class="code" href="structheffte_1_1backend_1_1device__instance.html#a2b63f0b1deb23636cee0bfc94ffb564c">backend::device_instance&lt;location_tag&gt;::stream_type</a> gpu_stream,</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;          <a class="code" href="structheffte_1_1box3d.html">box3d&lt;index&gt;</a> <span class="keyword">const</span> <a class="code" href="classheffte_1_1fft3d.html#a27524f300afc834cd2dddd25beaee4b8">inbox</a>, <a class="code" href="structheffte_1_1box3d.html">box3d&lt;index&gt;</a> <span class="keyword">const</span> <a class="code" href="classheffte_1_1fft3d.html#a42a94caa949610c56767f5e7987af8df">outbox</a>, MPI_Comm <span class="keyword">const</span> comm,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;          <a class="code" href="structheffte_1_1plan__options.html">plan_options</a> <span class="keyword">const</span> options = default_options&lt;backend_tag&gt;()) :</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <a class="code" href="classheffte_1_1fft3d.html">fft3d</a>(gpu_stream, <a class="code" href="group__fft3dplan.html#gadfe5ddda96e7aecb88edc7aeb07dbc91">plan_operations</a>(mpi::<a class="code" href="group__hefftempi.html#gacade914d344f3727d9e7d8dcfd13ed5a">gather_boxes</a>(<a class="code" href="classheffte_1_1fft3d.html#a27524f300afc834cd2dddd25beaee4b8">inbox</a>, <a class="code" href="classheffte_1_1fft3d.html#a42a94caa949610c56767f5e7987af8df">outbox</a>, comm), -1, <a class="code" href="group__fft3d.html#ga8c2c4b54da75fafbe68b3115d4390a66">set_options</a>&lt;backend_tag&gt;(options), mpi::<a class="code" href="group__hefftempi.html#ga5df7514ec8acb2b7bcc642892ed22f67">comm_rank</a>(comm)), comm){</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        static_assert(<a class="code" href="structheffte_1_1backend_1_1is__enabled.html">backend::is_enabled&lt;backend_tag&gt;::value</a>, <span class="stringliteral">&quot;The requested backend is invalid or has not been enabled.&quot;</span>);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#afce4f8d8c20c3a00201350ccb08efd82">  274</a></span>&#160;    <a class="code" href="classheffte_1_1fft3d.html#afce4f8d8c20c3a00201350ccb08efd82">fft3d</a>(<span class="keywordtype">int</span> il0, <span class="keywordtype">int</span> il1, <span class="keywordtype">int</span> il2, <span class="keywordtype">int</span> ih0, <span class="keywordtype">int</span> ih1, <span class="keywordtype">int</span> ih2, <span class="keywordtype">int</span> io0, <span class="keywordtype">int</span> io1, <span class="keywordtype">int</span> io2,</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          <span class="keywordtype">int</span> ol0, <span class="keywordtype">int</span> ol1, <span class="keywordtype">int</span> ol2, <span class="keywordtype">int</span> oh0, <span class="keywordtype">int</span> oh1, <span class="keywordtype">int</span> oh2, <span class="keywordtype">int</span> oo0, <span class="keywordtype">int</span> oo1, <span class="keywordtype">int</span> oo2,</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;          MPI_Comm <span class="keyword">const</span> comm,</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;          <span class="keywordtype">bool</span> use_reorder, <span class="keywordtype">int</span> algorithm, <span class="keywordtype">bool</span> use_pencils)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        : <a class="code" href="classheffte_1_1fft3d.html">fft3d</a>(<a class="code" href="structheffte_1_1box3d.html">box3d</a>&lt;index&gt;({il0, il1, il2}, {ih0, ih1, ih2}, {io0, io1, io2}),</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                box3d&lt;index&gt;({ol0, ol1, ol2}, {oh0, oh1, oh2}, {oo0, oo1, oo2}),</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                comm,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                plan_options(use_reorder, <span class="keyword">static_cast&lt;</span><a class="code" href="group__fft3d.html#ga4c9d07a6600d0e32939ec064c0604767">reshape_algorithm</a><span class="keyword">&gt;</span>(algorithm), use_pencils))</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    {}</div>
<div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#a4b040e785ab22ab8a7d1e97416c923a1">  284</a></span>&#160;    <a class="code" href="classheffte_1_1fft3d.html#a4b040e785ab22ab8a7d1e97416c923a1">fft3d</a>(<span class="keywordtype">int</span> il0, <span class="keywordtype">int</span> il1, <span class="keywordtype">int</span> il2, <span class="keywordtype">int</span> ih0, <span class="keywordtype">int</span> ih1, <span class="keywordtype">int</span> ih2, <span class="keywordtype">int</span> io0, <span class="keywordtype">int</span> io1, <span class="keywordtype">int</span> io2,</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;          <span class="keywordtype">int</span> ol0, <span class="keywordtype">int</span> ol1, <span class="keywordtype">int</span> ol2, <span class="keywordtype">int</span> oh0, <span class="keywordtype">int</span> oh1, <span class="keywordtype">int</span> oh2, <span class="keywordtype">int</span> oo0, <span class="keywordtype">int</span> oo1, <span class="keywordtype">int</span> oo2,</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;          MPI_Comm <span class="keyword">const</span> comm)</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        : <a class="code" href="classheffte_1_1fft3d.html">fft3d</a>(<a class="code" href="structheffte_1_1box3d.html">box3d</a>&lt;index&gt;({il0, il1, il2}, {ih0, ih1, ih2}, {io0, io1, io2}),</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                box3d&lt;index&gt;({ol0, ol1, ol2}, {oh0, oh1, oh2}, {oo0, oo1, oo2}),</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                comm)</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    {}</div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#ade8e59360229edef921a7fb243dc3c52">  292</a></span>&#160;    <a class="code" href="classheffte_1_1fft3d.html#ade8e59360229edef921a7fb243dc3c52">fft3d</a>(<span class="keywordtype">int</span> il0, <span class="keywordtype">int</span> il1, <span class="keywordtype">int</span> il2, <span class="keywordtype">int</span> ih0, <span class="keywordtype">int</span> ih1, <span class="keywordtype">int</span> ih2,</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;          <span class="keywordtype">int</span> ol0, <span class="keywordtype">int</span> ol1, <span class="keywordtype">int</span> ol2, <span class="keywordtype">int</span> oh0, <span class="keywordtype">int</span> oh1, <span class="keywordtype">int</span> oh2,</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;          MPI_Comm <span class="keyword">const</span> comm)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        : <a class="code" href="classheffte_1_1fft3d.html">fft3d</a>(<a class="code" href="structheffte_1_1box3d.html">box3d</a>&lt;index&gt;({il0, il1, il2}, {ih0, ih1, ih2}), box3d&lt;index&gt;({ol0, ol1, ol2}, {oh0, oh1, oh2}), comm)</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    {}</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#a1642e77a8b3f46da866434cbccdf82d9">  299</a></span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="classheffte_1_1fft3d.html#a1642e77a8b3f46da866434cbccdf82d9">size_inbox</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> pinbox-&gt;count(); }</div>
<div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#a726c48d33d5b5435f1798553b7a24aa5">  301</a></span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="classheffte_1_1fft3d.html#a726c48d33d5b5435f1798553b7a24aa5">size_outbox</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> poutbox-&gt;count(); }</div>
<div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#a27524f300afc834cd2dddd25beaee4b8">  303</a></span>&#160;    <a class="code" href="structheffte_1_1box3d.html">box3d&lt;index&gt;</a> <a class="code" href="classheffte_1_1fft3d.html#a27524f300afc834cd2dddd25beaee4b8">inbox</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> *pinbox; }</div>
<div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#a42a94caa949610c56767f5e7987af8df">  305</a></span>&#160;    <a class="code" href="structheffte_1_1box3d.html">box3d&lt;index&gt;</a> <a class="code" href="classheffte_1_1fft3d.html#a42a94caa949610c56767f5e7987af8df">outbox</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> *poutbox; }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> input_type, <span class="keyword">typename</span> output_type&gt;</div>
<div class="line"><a name="l00327"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#a249a705ba2a7b3de377d8ffa26283d12">  327</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classheffte_1_1fft3d.html#a249a705ba2a7b3de377d8ffa26283d12">forward</a>(input_type <span class="keyword">const</span> input[], output_type output[], <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling = <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        static_assert(<a class="code" href="structheffte_1_1backend_1_1check__types.html">backend::check_types&lt;backend_tag, input_type, output_type&gt;::value</a>,</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                      <span class="stringliteral">&quot;Using either an unknown complex type or an incompatible pair of types!&quot;</span>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keyword">auto</span> workspace = make_buffer_container&lt;typename transform_output&lt;typename define_standard_type&lt;output_type&gt;::type, backend_tag&gt;::type&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), <a class="code" href="classheffte_1_1fft3d.html#aa820b442a35660123c7f8e652a210a8c">size_workspace</a>());</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <a class="code" href="classheffte_1_1fft3d.html#a249a705ba2a7b3de377d8ffa26283d12">forward</a>(input, output, workspace.data(), scaling);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> input_type, <span class="keyword">typename</span> output_type&gt;</div>
<div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#a9a8d70947661542edbfea7105c62b930">  348</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classheffte_1_1fft3d.html#a9a8d70947661542edbfea7105c62b930">forward</a>(input_type <span class="keyword">const</span> input[], output_type output[], output_type workspace[], <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling = <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        static_assert(<a class="code" href="structheffte_1_1backend_1_1check__types.html">backend::check_types&lt;backend_tag, input_type, output_type&gt;::value</a>,</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                      <span class="stringliteral">&quot;Using either an unknown complex type or an incompatible pair of types!&quot;</span>);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        compute_transform&lt;location_tag, index&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), 1, <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(input), <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(output),</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                                               <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(workspace),</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                                               executor_buffer_offset, <a class="code" href="classheffte_1_1fft3d.html#afadef8ba323b3049cb81bf5d36186070">size_comm_buffers</a>(), forward_shaper,</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                                               forward_executors(), <a class="code" href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a965dbaac085fc891bfbbd4f9d145bbc8">direction::forward</a>);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        apply_scale(1, <a class="code" href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a965dbaac085fc891bfbbd4f9d145bbc8">direction::forward</a>, scaling, output);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> input_type, <span class="keyword">typename</span> output_type&gt;</div>
<div class="line"><a name="l00365"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#a165715d91c47e78fa5bf4e1dab9b17fd">  365</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classheffte_1_1fft3d.html#a165715d91c47e78fa5bf4e1dab9b17fd">forward</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> batch_size, input_type <span class="keyword">const</span> input[], output_type output[],</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                 output_type workspace[], <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling = <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        static_assert(<a class="code" href="structheffte_1_1backend_1_1check__types.html">backend::check_types&lt;backend_tag, input_type, output_type&gt;::value</a>,</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                      <span class="stringliteral">&quot;Using either an unknown complex type or an incompatible pair of types!&quot;</span>);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        compute_transform&lt;location_tag, index&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), batch_size, <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(input), <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(output),</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                                               <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(workspace),</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                               executor_buffer_offset, <a class="code" href="classheffte_1_1fft3d.html#afadef8ba323b3049cb81bf5d36186070">size_comm_buffers</a>(), forward_shaper,</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                                               forward_executors(), <a class="code" href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a965dbaac085fc891bfbbd4f9d145bbc8">direction::forward</a>);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        apply_scale(batch_size, <a class="code" href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a965dbaac085fc891bfbbd4f9d145bbc8">direction::forward</a>, scaling, output);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> input_type, <span class="keyword">typename</span> output_type&gt;</div>
<div class="line"><a name="l00380"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#afc19100751760ab9293560a1dc241fa8">  380</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classheffte_1_1fft3d.html#afc19100751760ab9293560a1dc241fa8">forward</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> batch_size, input_type <span class="keyword">const</span> input[], output_type output[], <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling = <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        static_assert(<a class="code" href="structheffte_1_1backend_1_1check__types.html">backend::check_types&lt;backend_tag, input_type, output_type&gt;::value</a>,</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                      <span class="stringliteral">&quot;Using either an unknown complex type or an incompatible pair of types!&quot;</span>);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="keyword">auto</span> workspace = make_buffer_container&lt;typename transform_output&lt;typename define_standard_type&lt;output_type&gt;::type, backend_tag&gt;::type&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), batch_size * <a class="code" href="classheffte_1_1fft3d.html#aa820b442a35660123c7f8e652a210a8c">size_workspace</a>());</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <a class="code" href="classheffte_1_1fft3d.html#a249a705ba2a7b3de377d8ffa26283d12">forward</a>(batch_size, input, output, workspace.data(), scaling);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> input_type&gt;</div>
<div class="line"><a name="l00414"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#ae1353a69326cea0ab6f63498ef3131d8">  414</a></span>&#160;    <a class="code" href="classheffte_1_1fft3d.html#a39f229cbf43a1e7eee55d762579e3a7e">output_buffer_container&lt;input_type&gt;</a> <a class="code" href="classheffte_1_1fft3d.html#ae1353a69326cea0ab6f63498ef3131d8">forward</a>(<a class="code" href="classheffte_1_1fft3d.html#aeb62ee60533b362f133f21cdd1911bec">buffer_container&lt;input_type&gt;</a> <span class="keyword">const</span> &amp;input, <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling = <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>){</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="keywordflow">if</span> (input.size() &lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code" href="classheffte_1_1fft3d.html#a1642e77a8b3f46da866434cbccdf82d9">size_inbox</a>()))</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;The input vector is smaller than size_inbox(), i.e., not enough entries provided to fill the inbox.&quot;</span>);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keyword">auto</span> output = make_buffer_container&lt;typename transform_output&lt;input_type, backend_tag&gt;::type&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), <a class="code" href="classheffte_1_1fft3d.html#a726c48d33d5b5435f1798553b7a24aa5">size_outbox</a>());</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <a class="code" href="classheffte_1_1fft3d.html#a249a705ba2a7b3de377d8ffa26283d12">forward</a>(input.data(), output.data(), scaling);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keywordflow">return</span> output;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> input_type, <span class="keyword">typename</span> output_type&gt;</div>
<div class="line"><a name="l00442"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#a1e723ec55ffaf3bb9e4534b31582e7f9">  442</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classheffte_1_1fft3d.html#a1e723ec55ffaf3bb9e4534b31582e7f9">backward</a>(input_type <span class="keyword">const</span> input[], output_type output[], <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling = <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        static_assert(<a class="code" href="structheffte_1_1backend_1_1check__types.html">backend::check_types&lt;backend_tag, output_type, input_type&gt;::value</a>,</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                      <span class="stringliteral">&quot;Using either an unknown complex type or an incompatible pair of types!&quot;</span>);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keyword">auto</span> workspace = make_buffer_container&lt;typename transform_output&lt;input_type, backend_tag&gt;::type&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), <a class="code" href="classheffte_1_1fft3d.html#aa820b442a35660123c7f8e652a210a8c">size_workspace</a>());</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <a class="code" href="classheffte_1_1fft3d.html#a1e723ec55ffaf3bb9e4534b31582e7f9">backward</a>(input, output, workspace.data(), scaling);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> input_type, <span class="keyword">typename</span> output_type&gt;</div>
<div class="line"><a name="l00454"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#a936868279c36a1984ffdea7f0efe07e7">  454</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classheffte_1_1fft3d.html#a936868279c36a1984ffdea7f0efe07e7">backward</a>(input_type <span class="keyword">const</span> input[], output_type output[], input_type workspace[], <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling = <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        static_assert(<a class="code" href="structheffte_1_1backend_1_1check__types.html">backend::check_types&lt;backend_tag, output_type, input_type&gt;::value</a>,</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                      <span class="stringliteral">&quot;Using either an unknown complex type or an incompatible pair of types!&quot;</span>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        compute_transform&lt;location_tag, index&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), 1, <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(input), <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(output),</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                                               <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(workspace),</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                                               executor_buffer_offset, <a class="code" href="classheffte_1_1fft3d.html#afadef8ba323b3049cb81bf5d36186070">size_comm_buffers</a>(), backward_shaper,</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                                               backward_executors(), <a class="code" href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a195fe59b6f103787a914aead0f3db502">direction::backward</a>);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        apply_scale(1, <a class="code" href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a195fe59b6f103787a914aead0f3db502">direction::backward</a>, scaling, output);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> input_type, <span class="keyword">typename</span> output_type&gt;</div>
<div class="line"><a name="l00468"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#abb8502a9d2d88c3fc9d610af5749c873">  468</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classheffte_1_1fft3d.html#abb8502a9d2d88c3fc9d610af5749c873">backward</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> batch_size, input_type <span class="keyword">const</span> input[], output_type output[],</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                  input_type workspace[], <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling = <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        static_assert(<a class="code" href="structheffte_1_1backend_1_1check__types.html">backend::check_types&lt;backend_tag, output_type, input_type&gt;::value</a>,</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                      <span class="stringliteral">&quot;Using either an unknown complex type or an incompatible pair of types!&quot;</span>);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        compute_transform&lt;location_tag, index&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), batch_size, <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(input), <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(output),</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                                               <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(workspace),</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                                               executor_buffer_offset, <a class="code" href="classheffte_1_1fft3d.html#afadef8ba323b3049cb81bf5d36186070">size_comm_buffers</a>(), backward_shaper,</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                                               backward_executors(), <a class="code" href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a195fe59b6f103787a914aead0f3db502">direction::backward</a>);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        apply_scale(batch_size, <a class="code" href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a195fe59b6f103787a914aead0f3db502">direction::backward</a>, scaling, output);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> input_type, <span class="keyword">typename</span> output_type&gt;</div>
<div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#a9a71a9d0dbd7845c0948db99284a9afa">  483</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classheffte_1_1fft3d.html#a9a71a9d0dbd7845c0948db99284a9afa">backward</a>(<span class="keywordtype">int</span> <span class="keyword">const</span> batch_size, input_type <span class="keyword">const</span> input[], output_type output[], <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling = <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        static_assert(<a class="code" href="structheffte_1_1backend_1_1check__types.html">backend::check_types&lt;backend_tag, output_type, input_type&gt;::value</a>,</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                      <span class="stringliteral">&quot;Using either an unknown complex type or an incompatible pair of types!&quot;</span>);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="keyword">auto</span> workspace = make_buffer_container&lt;typename transform_output&lt;input_type, backend_tag&gt;::type&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), batch_size * <a class="code" href="classheffte_1_1fft3d.html#aa820b442a35660123c7f8e652a210a8c">size_workspace</a>());</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <a class="code" href="classheffte_1_1fft3d.html#a1e723ec55ffaf3bb9e4534b31582e7f9">backward</a>(batch_size, input, output, workspace.data(), scaling);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    }</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> scalar_type&gt;</div>
<div class="line"><a name="l00495"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#a877dd9c619b4c8b09e73205b5e5c01e1">  495</a></span>&#160;    <a class="code" href="classheffte_1_1fft3d.html#aeb62ee60533b362f133f21cdd1911bec">buffer_container&lt;scalar_type&gt;</a> <a class="code" href="classheffte_1_1fft3d.html#a877dd9c619b4c8b09e73205b5e5c01e1">backward</a>(<a class="code" href="classheffte_1_1fft3d.html#aeb62ee60533b362f133f21cdd1911bec">buffer_container&lt;scalar_type&gt;</a> <span class="keyword">const</span> &amp;input, <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling = <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>){</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        static_assert(<a class="code" href="structheffte_1_1is__ccomplex.html">is_ccomplex&lt;scalar_type&gt;::value</a> or <a class="code" href="structheffte_1_1is__zcomplex.html">is_zcomplex&lt;scalar_type&gt;::value</a>,</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                      <span class="stringliteral">&quot;Either calling backward() with non-complex input or using an unknown complex type.&quot;</span>);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keywordflow">if</span> (input.size() &lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code" href="classheffte_1_1fft3d.html#a726c48d33d5b5435f1798553b7a24aa5">size_outbox</a>()))</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;The input vector is smaller than size_outbox(), i.e., not enough entries provided to fill the outbox.&quot;</span>);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keyword">auto</span> result = make_buffer_container&lt;scalar_type&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), <a class="code" href="classheffte_1_1fft3d.html#a1642e77a8b3f46da866434cbccdf82d9">size_inbox</a>());</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <a class="code" href="classheffte_1_1fft3d.html#a1e723ec55ffaf3bb9e4534b31582e7f9">backward</a>(input.data(), result.data(), scaling);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    }</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> scalar_type&gt;</div>
<div class="line"><a name="l00509"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#a1cbd206c99ed69d960e574a78295eaea">  509</a></span>&#160;    <a class="code" href="classheffte_1_1fft3d.html#adb9b0e347c94f2bdb5376a19e3d878b6">real_buffer_container&lt;scalar_type&gt;</a> <a class="code" href="classheffte_1_1fft3d.html#a1cbd206c99ed69d960e574a78295eaea">backward_real</a>(<a class="code" href="classheffte_1_1fft3d.html#aeb62ee60533b362f133f21cdd1911bec">buffer_container&lt;scalar_type&gt;</a> <span class="keyword">const</span> &amp;input, <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling = <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>){</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        static_assert(<a class="code" href="structheffte_1_1is__ccomplex.html">is_ccomplex&lt;scalar_type&gt;::value</a> or <a class="code" href="structheffte_1_1is__zcomplex.html">is_zcomplex&lt;scalar_type&gt;::value</a>,</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                      <span class="stringliteral">&quot;Either calling backward() with non-complex input or using an unknown complex type.&quot;</span>);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keyword">auto</span> result = make_buffer_container&lt;typename define_standard_type&lt;scalar_type&gt;::type::value_type&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), <a class="code" href="classheffte_1_1fft3d.html#a1642e77a8b3f46da866434cbccdf82d9">size_inbox</a>());</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <a class="code" href="classheffte_1_1fft3d.html#a1e723ec55ffaf3bb9e4534b31582e7f9">backward</a>(input.data(), result.data(), scaling);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#a3b53983101465e795f039b7c3ee995b3">  518</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classheffte_1_1fft3d.html#a3b53983101465e795f039b7c3ee995b3">get_scale_factor</a>(<a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structheffte_1_1backend_1_1uses__fft__types.html">backend::uses_fft_types&lt;backend_tag&gt;::value</a>){</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            <span class="keywordflow">return</span> (scaling == <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cbafeca3c730601be7fd57f1f0b668b4637">scale::symmetric</a>) ? std::sqrt(scale_factor) : scale_factor;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="keywordflow">return</span> (scaling == <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cbafeca3c730601be7fd57f1f0b668b4637">scale::symmetric</a>) ? std::sqrt(scale_factor / 64.0) : scale_factor / 64.0;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        }</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#aa820b442a35660123c7f8e652a210a8c">  527</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="classheffte_1_1fft3d.html#aa820b442a35660123c7f8e652a210a8c">size_workspace</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> size_buffer_work; }</div>
<div class="line"><a name="l00529"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d.html#afadef8ba323b3049cb81bf5d36186070">  529</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="classheffte_1_1fft3d.html#afadef8ba323b3049cb81bf5d36186070">size_comm_buffers</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> comm_buffer_offset; }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <a class="code" href="classheffte_1_1fft3d.html#a1d337dece28dd2d2aa0e93af04f9763b">fft3d</a>(<a class="code" href="structheffte_1_1logic__plan3d.html">logic_plan3d&lt;index&gt;</a> <span class="keyword">const</span> &amp;plan, MPI_Comm <span class="keyword">const</span> comm)  :</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        backend::<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a641aa853208673ca6458c1f9cfecc01c">device_instance</a>&lt;<a class="code" href="classheffte_1_1fft3d.html#a3b9d2b3e80788752589804c64b9b4afc">location_tag</a>&gt;(),</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        pinbox(new <a class="code" href="structheffte_1_1box3d.html">box3d</a>&lt;index&gt;(plan.in_shape[0][plan.mpi_rank])), poutbox(new <a class="code" href="structheffte_1_1box3d.html">box3d</a>&lt;index&gt;(plan.out_shape[3][plan.mpi_rank])),</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        scale_factor(1.0 / static_cast&lt;double&gt;(plan.index_count))</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        #ifdef Heffte_ENABLE_MAGMA</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        , hmagma(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>())</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        #endif</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    {</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        setup(plan, comm);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <a class="code" href="classheffte_1_1fft3d.html#a1d337dece28dd2d2aa0e93af04f9763b">fft3d</a>(<span class="keyword">typename</span> <a class="code" href="structheffte_1_1backend_1_1device__instance.html#a2b63f0b1deb23636cee0bfc94ffb564c">backend::device_instance&lt;location_tag&gt;::stream_type</a> gpu_stream,</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;          logic_plan3d&lt;index&gt; <span class="keyword">const</span> &amp;plan, MPI_Comm <span class="keyword">const</span> comm) :</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        backend::<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a641aa853208673ca6458c1f9cfecc01c">device_instance</a>&lt;<a class="code" href="classheffte_1_1fft3d.html#a3b9d2b3e80788752589804c64b9b4afc">location_tag</a>&gt;(gpu_stream),</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        pinbox(new box3d&lt;index&gt;(plan.in_shape[0][plan.mpi_rank])), poutbox(new box3d&lt;index&gt;(plan.out_shape[3][plan.mpi_rank])),</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        scale_factor(1.0 / static_cast&lt;double&gt;(plan.index_count))</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        #ifdef Heffte_ENABLE_MAGMA</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        , hmagma(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>())</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        #endif</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        setup(plan, comm);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordtype">void</span> setup(logic_plan3d&lt;index&gt; <span class="keyword">const</span> &amp;plan, MPI_Comm <span class="keyword">const</span> comm){</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;4; i++){</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            forward_shaper[i]    = make_reshape3d&lt;backend_tag&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), plan.in_shape[i], plan.out_shape[i], comm, plan.options);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            backward_shaper[3-i] = make_reshape3d&lt;backend_tag&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), plan.out_shape[i], plan.in_shape[i], comm, plan.options);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="keywordtype">int</span> <span class="keyword">const</span> my_rank = plan.mpi_rank;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keywordflow">if</span> (has_executor3d&lt;backend_tag&gt;() and not forward_shaper[1] and not forward_shaper[2]){</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            executors[0] = make_executor&lt;backend_tag&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), plan.out_shape[0][my_rank]);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (has_executor2d&lt;backend_tag&gt;() and (not forward_shaper[1] or not forward_shaper[2])){</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <span class="keywordflow">if</span> (not forward_shaper[1]){</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                executors[0] = make_executor&lt;backend_tag&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), plan.out_shape[0][my_rank],</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                                                          plan.fft_direction[0], plan.fft_direction[1]);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                executors[2] = make_executor&lt;backend_tag&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), plan.out_shape[2][my_rank], plan.fft_direction[2]);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                executors[0] = make_executor&lt;backend_tag&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), plan.out_shape[0][my_rank], plan.fft_direction[0]);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                executors[2] = make_executor&lt;backend_tag&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), plan.out_shape[2][my_rank],</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                                                          plan.fft_direction[1], plan.fft_direction[2]);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            executors[0] = make_executor&lt;backend_tag&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), plan.out_shape[0][my_rank], plan.fft_direction[0]);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            executors[1] = make_executor&lt;backend_tag&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), plan.out_shape[1][my_rank], plan.fft_direction[1]);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            executors[2] = make_executor&lt;backend_tag&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), plan.out_shape[2][my_rank], plan.fft_direction[2]);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <span class="keywordtype">size_t</span> executor_workspace_size = <a class="code" href="group__fft3dmisc.html#gaf5806a52f52a1dd1b316d52e742b187c">get_max_work_size</a>(executors);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        comm_buffer_offset = std::max(<a class="code" href="group__hefftereshape.html#gadd1dabaa0d659f85b6c882c2a14cd895">get_workspace_size</a>(forward_shaper), <a class="code" href="group__hefftereshape.html#gadd1dabaa0d659f85b6c882c2a14cd895">get_workspace_size</a>(backward_shaper));</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <span class="comment">// the last junk of (fft0-&gt;box_size() + 1) / 2 is used only when doing complex-to-real backward transform</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="comment">// maybe update the API to call for different size buffers for different complex/real types</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordtype">int</span> last_chunk = (executors[0] == <span class="keyword">nullptr</span>) ? 0 : (((backward_shaper[3]) ? (executors[0]-&gt;box_size() + 1) / 2 : 0));</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        size_buffer_work =  comm_buffer_offset + executor_workspace_size</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                          + <a class="code" href="group__fft3dmisc.html#ga584aebef9e3918544eb43dada556168e">get_max_box_size</a>(executors)</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                          + last_chunk;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        executor_buffer_offset = (executor_workspace_size == 0) ? 0 : size_buffer_work - executor_workspace_size;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    }</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    std::array&lt;executor_base*, 3&gt; forward_executors()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordflow">return</span> std::array&lt;executor_base*, 3&gt;{executors[0].get(), executors[1].get(), executors[2].get()};</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    std::array&lt;executor_base*, 3&gt; backward_executors()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keywordflow">return</span> std::array&lt;executor_base*, 3&gt;{executors[2].get(), executors[1].get(), executors[0].get()};</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> scalar_type&gt;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordtype">void</span> apply_scale(<span class="keywordtype">int</span> <span class="keyword">const</span> batch_size, <a class="code" href="group__fft3dmisc.html#ga2738b0dcfd330cf26181036ee5133a09">direction</a> dir, <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling, scalar_type data[])<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="keywordflow">if</span> (scaling != <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>){</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            add_trace <a class="code" href="group__fft3dbackend.html#ga65d6597fd795ca487089c90a6052afab">name</a>(<span class="stringliteral">&quot;scale&quot;</span>);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="preprocessor">            #ifdef Heffte_ENABLE_MAGMA</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <span class="keywordflow">if</span> (std::is_same&lt;<span class="keyword">typename</span> <a class="code" href="structheffte_1_1backend_1_1buffer__traits.html#a086cd1f9f7b4d1c4aacbf4c312a9d839">backend::buffer_traits&lt;backend_tag&gt;::location</a>, tag::gpu&gt;::value){</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                hmagma.scal(batch_size * ((dir == <a class="code" href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a965dbaac085fc891bfbbd4f9d145bbc8">direction::forward</a>) ? <a class="code" href="classheffte_1_1fft3d.html#a726c48d33d5b5435f1798553b7a24aa5">size_outbox</a>() : <a class="code" href="classheffte_1_1fft3d.html#a1642e77a8b3f46da866434cbccdf82d9">size_inbox</a>()),</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                            <a class="code" href="classheffte_1_1fft3d.html#a3b53983101465e795f039b7c3ee995b3">get_scale_factor</a>(scaling), data);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            }</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            <a class="code" href="group__hefftecuda.html#ga2b39bc4364fc371a804e17238b7ac566">data_scaling::apply</a>(</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(),</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                batch_size * ((dir == <a class="code" href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a965dbaac085fc891bfbbd4f9d145bbc8">direction::forward</a>) ? <a class="code" href="classheffte_1_1fft3d.html#a726c48d33d5b5435f1798553b7a24aa5">size_outbox</a>() : <a class="code" href="classheffte_1_1fft3d.html#a1642e77a8b3f46da866434cbccdf82d9">size_inbox</a>()),</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                data, <a class="code" href="classheffte_1_1fft3d.html#a3b53983101465e795f039b7c3ee995b3">get_scale_factor</a>(scaling));</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        }</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    std::unique_ptr&lt;box3d&lt;index&gt;&gt; pinbox, poutbox; <span class="comment">// inbox/output for this process</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordtype">double</span> scale_factor;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    std::array&lt;std::unique_ptr&lt;reshape3d_base&lt;index&gt;&gt;, 4&gt; forward_shaper;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    std::array&lt;std::unique_ptr&lt;reshape3d_base&lt;index&gt;&gt;, 4&gt; backward_shaper;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    std::array&lt;std::unique_ptr&lt;executor_base&gt;, 3&gt; executors;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="preprocessor">    #ifdef Heffte_ENABLE_MAGMA</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    gpu::magma_handle&lt;typename backend::buffer_traits&lt;backend_tag&gt;::location&gt; hmagma;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="comment">// cache some values for faster read</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordtype">size_t</span> size_buffer_work, comm_buffer_offset, executor_buffer_offset;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;};</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> backend_tag, <span class="keyword">typename</span> index = <span class="keywordtype">int</span>&gt;</div>
<div class="line"><a name="l00663"></a><span class="lineno"><a class="line" href="group__fft3d.html#gae1c290d6e7524bf4faf29201508e888b">  663</a></span>&#160;<span class="keyword">using</span> <a class="code" href="classheffte_1_1fft3d.html">fft2d</a> = <a class="code" href="classheffte_1_1fft3d.html">fft3d&lt;backend_tag, index&gt;</a>;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> backend_tag, <span class="keyword">typename</span> index = <span class="keywordtype">int</span>&gt;</div>
<div class="line"><a name="l00709"></a><span class="lineno"><a class="line" href="group__fft3d.html#ga4231b1482a0c4a46f6a7cfa4cec9e085">  709</a></span>&#160;<span class="keyword">using</span> <a class="code" href="classheffte_1_1fft3d.html">rtransform</a> = <a class="code" href="classheffte_1_1fft3d.html">fft3d&lt;backend_tag, index&gt;</a>;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> backend_tag, <span class="keyword">typename</span> index&gt;</div>
<div class="line"><a name="l00716"></a><span class="lineno"><a class="line" href="group__fft3d.html#gae17ca58e7a5d173ed09af842dda2b8e4">  716</a></span>&#160;<a class="code" href="classheffte_1_1fft3d.html">fft3d&lt;backend_tag, index&gt;</a> <a class="code" href="group__fft3d.html#gae17ca58e7a5d173ed09af842dda2b8e4">make_fft3d</a>(<a class="code" href="structheffte_1_1box3d.html">box3d&lt;index&gt;</a> <span class="keyword">const</span> inbox, <a class="code" href="structheffte_1_1box3d.html">box3d&lt;index&gt;</a> <span class="keyword">const</span> outbox, MPI_Comm <span class="keyword">const</span> comm,</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                                     <a class="code" href="structheffte_1_1plan__options.html">plan_options</a> <span class="keyword">const</span> options = default_options&lt;backend_tag&gt;()){</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    static_assert(std::is_same&lt;index, int&gt;::value or std::is_same&lt;index, long long&gt;::value,</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                  <span class="stringliteral">&quot;heFFTe works with &#39;int&#39; and &#39;long long&#39; indexing only&quot;</span>);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    static_assert(<a class="code" href="structheffte_1_1backend_1_1is__enabled.html">backend::is_enabled&lt;backend_tag&gt;::value</a>,</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                  <span class="stringliteral">&quot;the backend_tag is not valid, perhaps it needs to be enabled in the build system&quot;</span>);</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classheffte_1_1fft3d.html">fft3d&lt;backend_tag, index&gt;</a>(inbox, outbox, comm, options);</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;}</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;}</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html"><div class="ttname"><a href="classheffte_1_1fft3d.html">heffte::fft3d</a></div><div class="ttdoc">Defines the plan for a 3-dimensional discrete Fourier transform performed on a MPI distributed data.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:213</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_a1642e77a8b3f46da866434cbccdf82d9"><div class="ttname"><a href="classheffte_1_1fft3d.html#a1642e77a8b3f46da866434cbccdf82d9">heffte::fft3d::size_inbox</a></div><div class="ttdeci">long long size_inbox() const</div><div class="ttdoc">Returns the size of the inbox defined in the constructor.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:299</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_a165715d91c47e78fa5bf4e1dab9b17fd"><div class="ttname"><a href="classheffte_1_1fft3d.html#a165715d91c47e78fa5bf4e1dab9b17fd">heffte::fft3d::forward</a></div><div class="ttdeci">void forward(int const batch_size, input_type const input[], output_type output[], output_type workspace[], scale scaling=scale::none) const</div><div class="ttdoc">An overload allowing for a batch of FFTs to be performed in a single command.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:365</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_a1cbd206c99ed69d960e574a78295eaea"><div class="ttname"><a href="classheffte_1_1fft3d.html#a1cbd206c99ed69d960e574a78295eaea">heffte::fft3d::backward_real</a></div><div class="ttdeci">real_buffer_container&lt; scalar_type &gt; backward_real(buffer_container&lt; scalar_type &gt; const &amp;input, scale scaling=scale::none)</div><div class="ttdoc">Perform complex-to-real backward FFT using vector API (truncates the complex part).</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:509</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_a1d337dece28dd2d2aa0e93af04f9763b"><div class="ttname"><a href="classheffte_1_1fft3d.html#a1d337dece28dd2d2aa0e93af04f9763b">heffte::fft3d::fft3d</a></div><div class="ttdeci">fft3d(box3d&lt; index &gt; const inbox, box3d&lt; index &gt; const outbox, MPI_Comm const comm, plan_options const options=default_options&lt; backend_tag &gt;())</div><div class="ttdoc">Constructor creating a plan for FFT transform across the given communicator and using the box geometr...</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:243</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_a1e723ec55ffaf3bb9e4534b31582e7f9"><div class="ttname"><a href="classheffte_1_1fft3d.html#a1e723ec55ffaf3bb9e4534b31582e7f9">heffte::fft3d::backward</a></div><div class="ttdeci">void backward(input_type const input[], output_type output[], scale scaling=scale::none) const</div><div class="ttdoc">Performs a backward Fourier transform using two arrays.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:442</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_a249a705ba2a7b3de377d8ffa26283d12"><div class="ttname"><a href="classheffte_1_1fft3d.html#a249a705ba2a7b3de377d8ffa26283d12">heffte::fft3d::forward</a></div><div class="ttdeci">void forward(input_type const input[], output_type output[], scale scaling=scale::none) const</div><div class="ttdoc">Performs a forward Fourier transform using two arrays.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:327</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_a27524f300afc834cd2dddd25beaee4b8"><div class="ttname"><a href="classheffte_1_1fft3d.html#a27524f300afc834cd2dddd25beaee4b8">heffte::fft3d::inbox</a></div><div class="ttdeci">box3d&lt; index &gt; inbox() const</div><div class="ttdoc">Returns the inbox.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:303</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_a39f229cbf43a1e7eee55d762579e3a7e"><div class="ttname"><a href="classheffte_1_1fft3d.html#a39f229cbf43a1e7eee55d762579e3a7e">heffte::fft3d::output_buffer_container</a></div><div class="ttdeci">buffer_container&lt; typename transform_output&lt; T, backend_tag &gt;::type &gt; output_buffer_container</div><div class="ttdoc">Container of the output type corresponding to T, see the table of compatible input and output types.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:228</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_a3b53983101465e795f039b7c3ee995b3"><div class="ttname"><a href="classheffte_1_1fft3d.html#a3b53983101465e795f039b7c3ee995b3">heffte::fft3d::get_scale_factor</a></div><div class="ttdeci">double get_scale_factor(scale scaling) const</div><div class="ttdoc">Returns the scale factor for the given scaling.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:518</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_a3b9d2b3e80788752589804c64b9b4afc"><div class="ttname"><a href="classheffte_1_1fft3d.html#a3b9d2b3e80788752589804c64b9b4afc">heffte::fft3d::location_tag</a></div><div class="ttdeci">typename backend::buffer_traits&lt; backend_tag &gt;::location location_tag</div><div class="ttdoc">Type-tag that is either tag::cpu or tag::gpu to indicate the location of the data.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:233</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_a42a94caa949610c56767f5e7987af8df"><div class="ttname"><a href="classheffte_1_1fft3d.html#a42a94caa949610c56767f5e7987af8df">heffte::fft3d::outbox</a></div><div class="ttdeci">box3d&lt; index &gt; outbox() const</div><div class="ttdoc">Returns the outbox.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:305</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_a4b040e785ab22ab8a7d1e97416c923a1"><div class="ttname"><a href="classheffte_1_1fft3d.html#a4b040e785ab22ab8a7d1e97416c923a1">heffte::fft3d::fft3d</a></div><div class="ttdeci">fft3d(int il0, int il1, int il2, int ih0, int ih1, int ih2, int io0, int io1, int io2, int ol0, int ol1, int ol2, int oh0, int oh1, int oh2, int oo0, int oo1, int oo2, MPI_Comm const comm)</div><div class="ttdoc">Internal use only, used by the Fortran interface.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:284</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_a726c48d33d5b5435f1798553b7a24aa5"><div class="ttname"><a href="classheffte_1_1fft3d.html#a726c48d33d5b5435f1798553b7a24aa5">heffte::fft3d::size_outbox</a></div><div class="ttdeci">long long size_outbox() const</div><div class="ttdoc">Returns the size of the outbox defined in the constructor.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:301</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_a877dd9c619b4c8b09e73205b5e5c01e1"><div class="ttname"><a href="classheffte_1_1fft3d.html#a877dd9c619b4c8b09e73205b5e5c01e1">heffte::fft3d::backward</a></div><div class="ttdeci">buffer_container&lt; scalar_type &gt; backward(buffer_container&lt; scalar_type &gt; const &amp;input, scale scaling=scale::none)</div><div class="ttdoc">Perform complex-to-complex backward FFT using vector API.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:495</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_a936868279c36a1984ffdea7f0efe07e7"><div class="ttname"><a href="classheffte_1_1fft3d.html#a936868279c36a1984ffdea7f0efe07e7">heffte::fft3d::backward</a></div><div class="ttdeci">void backward(input_type const input[], output_type output[], input_type workspace[], scale scaling=scale::none) const</div><div class="ttdoc">Overload with user-provided workspace buffer, see the corresponding overload of forward().</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:454</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_a9a71a9d0dbd7845c0948db99284a9afa"><div class="ttname"><a href="classheffte_1_1fft3d.html#a9a71a9d0dbd7845c0948db99284a9afa">heffte::fft3d::backward</a></div><div class="ttdeci">void backward(int const batch_size, input_type const input[], output_type output[], scale scaling=scale::none) const</div><div class="ttdoc">Overload for batch transforms with internally allocated workspace.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:483</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_a9a8d70947661542edbfea7105c62b930"><div class="ttname"><a href="classheffte_1_1fft3d.html#a9a8d70947661542edbfea7105c62b930">heffte::fft3d::forward</a></div><div class="ttdeci">void forward(input_type const input[], output_type output[], output_type workspace[], scale scaling=scale::none) const</div><div class="ttdoc">An overload utilizing a user-allocated workspace buffer.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:348</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_aa820b442a35660123c7f8e652a210a8c"><div class="ttname"><a href="classheffte_1_1fft3d.html#aa820b442a35660123c7f8e652a210a8c">heffte::fft3d::size_workspace</a></div><div class="ttdeci">size_t size_workspace() const</div><div class="ttdoc">Returns the workspace size that will be used, size is measured in complex numbers.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:527</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_ab5794a91773074377e6e59ded8face53"><div class="ttname"><a href="classheffte_1_1fft3d.html#ab5794a91773074377e6e59ded8face53">heffte::fft3d::fft3d</a></div><div class="ttdeci">fft3d(typename backend::device_instance&lt; location_tag &gt;::stream_type gpu_stream, box3d&lt; index &gt; const inbox, box3d&lt; index &gt; const outbox, MPI_Comm const comm, plan_options const options=default_options&lt; backend_tag &gt;())</div><div class="ttdoc">Identical to the other constructor but accepts a GPU stream or queue.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:265</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_abb8502a9d2d88c3fc9d610af5749c873"><div class="ttname"><a href="classheffte_1_1fft3d.html#abb8502a9d2d88c3fc9d610af5749c873">heffte::fft3d::backward</a></div><div class="ttdeci">void backward(int const batch_size, input_type const input[], output_type output[], input_type workspace[], scale scaling=scale::none) const</div><div class="ttdoc">Overload for batch transforms, see the corresponding overload of forward().</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:468</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_ac5d40d64cf59b863e7478209996d6107"><div class="ttname"><a href="classheffte_1_1fft3d.html#ac5d40d64cf59b863e7478209996d6107">heffte::fft3d::backend_executor</a></div><div class="ttdeci">typename one_dim_backend&lt; backend_tag &gt;::executor backend_executor</div><div class="ttdoc">Alias to the wrapper class for the one dimensional backend library.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:216</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_adb9b0e347c94f2bdb5376a19e3d878b6"><div class="ttname"><a href="classheffte_1_1fft3d.html#adb9b0e347c94f2bdb5376a19e3d878b6">heffte::fft3d::real_buffer_container</a></div><div class="ttdeci">buffer_container&lt; typename define_standard_type&lt; T &gt;::type::value_type &gt; real_buffer_container</div><div class="ttdoc">Container of real values corresponding to the complex type T.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:226</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_ade8e59360229edef921a7fb243dc3c52"><div class="ttname"><a href="classheffte_1_1fft3d.html#ade8e59360229edef921a7fb243dc3c52">heffte::fft3d::fft3d</a></div><div class="ttdeci">fft3d(int il0, int il1, int il2, int ih0, int ih1, int ih2, int ol0, int ol1, int ol2, int oh0, int oh1, int oh2, MPI_Comm const comm)</div><div class="ttdoc">Internal use only, used by the Fortran interface.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:292</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_ae1353a69326cea0ab6f63498ef3131d8"><div class="ttname"><a href="classheffte_1_1fft3d.html#ae1353a69326cea0ab6f63498ef3131d8">heffte::fft3d::forward</a></div><div class="ttdeci">output_buffer_container&lt; input_type &gt; forward(buffer_container&lt; input_type &gt; const &amp;input, scale scaling=scale::none)</div><div class="ttdoc">Vector variant of forward() using input and output buffer_container classes.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:414</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_aeb62ee60533b362f133f21cdd1911bec"><div class="ttname"><a href="classheffte_1_1fft3d.html#aeb62ee60533b362f133f21cdd1911bec">heffte::fft3d::buffer_container</a></div><div class="ttdeci">typename backend::buffer_traits&lt; backend_tag &gt;::template container&lt; T &gt; buffer_container</div><div class="ttdoc">Alias to the container template associated with the backend.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:224</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_afadef8ba323b3049cb81bf5d36186070"><div class="ttname"><a href="classheffte_1_1fft3d.html#afadef8ba323b3049cb81bf5d36186070">heffte::fft3d::size_comm_buffers</a></div><div class="ttdeci">size_t size_comm_buffers() const</div><div class="ttdoc">Returns the size used by the communication workspace buffers (internal use).</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:529</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_afc19100751760ab9293560a1dc241fa8"><div class="ttname"><a href="classheffte_1_1fft3d.html#afc19100751760ab9293560a1dc241fa8">heffte::fft3d::forward</a></div><div class="ttdeci">void forward(int const batch_size, input_type const input[], output_type output[], scale scaling=scale::none) const</div><div class="ttdoc">An overload that allocates workspace internally.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:380</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d_html_afce4f8d8c20c3a00201350ccb08efd82"><div class="ttname"><a href="classheffte_1_1fft3d.html#afce4f8d8c20c3a00201350ccb08efd82">heffte::fft3d::fft3d</a></div><div class="ttdeci">fft3d(int il0, int il1, int il2, int ih0, int ih1, int ih2, int io0, int io1, int io2, int ol0, int ol1, int ol2, int oh0, int oh1, int oh2, int oo0, int oo1, int oo2, MPI_Comm const comm, bool use_reorder, int algorithm, bool use_pencils)</div><div class="ttdoc">Internal use only, used by the Fortran interface.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:274</div></div>
<div class="ttc" id="agroup__fft3d_html_ga4c9d07a6600d0e32939ec064c0604767"><div class="ttname"><a href="group__fft3d.html#ga4c9d07a6600d0e32939ec064c0604767">heffte::reshape_algorithm</a></div><div class="ttdeci">reshape_algorithm</div><div class="ttdoc">Defines list of potential communication algorithms.</div><div class="ttdef"><b>Definition:</b> heffte_plan_logic.h:48</div></div>
<div class="ttc" id="agroup__fft3d_html_ga8c2c4b54da75fafbe68b3115d4390a66"><div class="ttname"><a href="group__fft3d.html#ga8c2c4b54da75fafbe68b3115d4390a66">heffte::set_options</a></div><div class="ttdeci">plan_options set_options(plan_options opts)</div><div class="ttdoc">Adjusts the user provided options to what can be handled by the backend.</div><div class="ttdef"><b>Definition:</b> heffte_plan_logic.h:207</div></div>
<div class="ttc" id="agroup__fft3d_html_gae0a0922e2be72d5af2c9faad038874cb"><div class="ttname"><a href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">heffte::scale</a></div><div class="ttdeci">scale</div><div class="ttdoc">Indicates the scaling factor to apply on the result of an FFT operation.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:113</div></div>
<div class="ttc" id="agroup__fft3d_html_gae17ca58e7a5d173ed09af842dda2b8e4"><div class="ttname"><a href="group__fft3d.html#gae17ca58e7a5d173ed09af842dda2b8e4">heffte::make_fft3d</a></div><div class="ttdeci">fft3d&lt; backend_tag, index &gt; make_fft3d(box3d&lt; index &gt; const inbox, box3d&lt; index &gt; const outbox, MPI_Comm const comm, plan_options const options=default_options&lt; backend_tag &gt;())</div><div class="ttdoc">Factory method that auto-detects the index type based on the box.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:716</div></div>
<div class="ttc" id="agroup__fft3d_html_ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8"><div class="ttname"><a href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">heffte::scale::none</a></div><div class="ttdeci">@ none</div><div class="ttdoc">No scale, leave the result unperturbed similar to the FFTW API.</div></div>
<div class="ttc" id="agroup__fft3d_html_ggae0a0922e2be72d5af2c9faad038874cbae9dc924f238fa6cc29465942875fe8f0"><div class="ttname"><a href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cbae9dc924f238fa6cc29465942875fe8f0">heffte::scale::full</a></div><div class="ttdeci">@ full</div><div class="ttdoc">Apply the full scale, divide by the number of elements in the world box.</div></div>
<div class="ttc" id="agroup__fft3d_html_ggae0a0922e2be72d5af2c9faad038874cbafeca3c730601be7fd57f1f0b668b4637"><div class="ttname"><a href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cbafeca3c730601be7fd57f1f0b668b4637">heffte::scale::symmetric</a></div><div class="ttdeci">@ symmetric</div><div class="ttdoc">Symmetric scaling, apply the square-root of the full scaling.</div></div>
<div class="ttc" id="agroup__fft3dbackend_html_ga65d6597fd795ca487089c90a6052afab"><div class="ttname"><a href="group__fft3dbackend.html#ga65d6597fd795ca487089c90a6052afab">heffte::backend::name</a></div><div class="ttdeci">std::string name()</div><div class="ttdoc">Returns the human readable name of the backend.</div><div class="ttdef"><b>Definition:</b> heffte_common.h:240</div></div>
<div class="ttc" id="agroup__fft3dmisc_html_ga2738b0dcfd330cf26181036ee5133a09"><div class="ttname"><a href="group__fft3dmisc.html#ga2738b0dcfd330cf26181036ee5133a09">heffte::direction</a></div><div class="ttdeci">direction</div><div class="ttdoc">Indicates the direction of the FFT (internal use only).</div><div class="ttdef"><b>Definition:</b> heffte_common.h:535</div></div>
<div class="ttc" id="agroup__fft3dmisc_html_ga584aebef9e3918544eb43dada556168e"><div class="ttname"><a href="group__fft3dmisc.html#ga584aebef9e3918544eb43dada556168e">heffte::get_max_box_size</a></div><div class="ttdeci">size_t get_max_box_size(std::array&lt; some_class, 3 &gt; const &amp;executors)</div><div class="ttdoc">Returns the max of the box_size() for each of the executors.</div><div class="ttdef"><b>Definition:</b> heffte_utils.h:402</div></div>
<div class="ttc" id="agroup__fft3dmisc_html_gaf5806a52f52a1dd1b316d52e742b187c"><div class="ttname"><a href="group__fft3dmisc.html#gaf5806a52f52a1dd1b316d52e742b187c">heffte::get_max_work_size</a></div><div class="ttdeci">size_t get_max_work_size(std::array&lt; some_class, 3 &gt; const &amp;executors)</div><div class="ttdoc">Returns the max of the workspace_size() for each of the executors.</div><div class="ttdef"><b>Definition:</b> heffte_utils.h:423</div></div>
<div class="ttc" id="agroup__fft3dmisc_html_gga2738b0dcfd330cf26181036ee5133a09a195fe59b6f103787a914aead0f3db502"><div class="ttname"><a href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a195fe59b6f103787a914aead0f3db502">heffte::direction::backward</a></div><div class="ttdeci">@ backward</div><div class="ttdoc">Inverse DFT transform.</div></div>
<div class="ttc" id="agroup__fft3dmisc_html_gga2738b0dcfd330cf26181036ee5133a09a965dbaac085fc891bfbbd4f9d145bbc8"><div class="ttname"><a href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a965dbaac085fc891bfbbd4f9d145bbc8">heffte::direction::forward</a></div><div class="ttdeci">@ forward</div><div class="ttdoc">Forward DFT transform.</div></div>
<div class="ttc" id="agroup__fft3dplan_html_gadfe5ddda96e7aecb88edc7aeb07dbc91"><div class="ttname"><a href="group__fft3dplan.html#gadfe5ddda96e7aecb88edc7aeb07dbc91">heffte::plan_operations</a></div><div class="ttdeci">logic_plan3d&lt; index &gt; plan_operations(ioboxes&lt; index &gt; const &amp;boxes, int r2c_direction, plan_options const options, int const mpi_rank)</div><div class="ttdoc">Creates the logic plan with the provided user input.</div><div class="ttdef"><b>Definition:</b> heffte_plan_logic.cpp:421</div></div>
<div class="ttc" id="agroup__hefftecuda_html_ga2b39bc4364fc371a804e17238b7ac566"><div class="ttname"><a href="group__hefftecuda.html#ga2b39bc4364fc371a804e17238b7ac566">heffte::data_scaling::apply</a></div><div class="ttdeci">void apply(cudaStream_t stream, index num_entries, scalar_type *data, double scale_factor)</div><div class="ttdoc">Simply multiply the num_entries in the data by the scale_factor.</div><div class="ttdef"><b>Definition:</b> heffte_backend_cuda.h:796</div></div>
<div class="ttc" id="agroup__hefftempi_html_ga5df7514ec8acb2b7bcc642892ed22f67"><div class="ttname"><a href="group__hefftempi.html#ga5df7514ec8acb2b7bcc642892ed22f67">heffte::mpi::comm_rank</a></div><div class="ttdeci">int comm_rank(MPI_Comm const comm)</div><div class="ttdoc">Returns the rank of this process within the specified comm.</div><div class="ttdef"><b>Definition:</b> heffte_utils.h:78</div></div>
<div class="ttc" id="agroup__hefftempi_html_gacade914d344f3727d9e7d8dcfd13ed5a"><div class="ttname"><a href="group__hefftempi.html#gacade914d344f3727d9e7d8dcfd13ed5a">heffte::mpi::gather_boxes</a></div><div class="ttdeci">ioboxes&lt; index &gt; gather_boxes(box3d&lt; index &gt; const my_inbox, box3d&lt; index &gt; const my_outbox, MPI_Comm const comm)</div><div class="ttdoc">Gather all boxes across all ranks in the comm.</div><div class="ttdef"><b>Definition:</b> heffte_geometry.h:697</div></div>
<div class="ttc" id="agroup__hefftereshape_html_gadd1dabaa0d659f85b6c882c2a14cd895"><div class="ttname"><a href="group__hefftereshape.html#gadd1dabaa0d659f85b6c882c2a14cd895">heffte::get_workspace_size</a></div><div class="ttdeci">size_t get_workspace_size(std::array&lt; std::unique_ptr&lt; reshape3d_base&lt; index &gt;&gt;, 4 &gt; const &amp;shapers)</div><div class="ttdoc">Returns the maximum workspace size used by the shapers.</div><div class="ttdef"><b>Definition:</b> heffte_reshape3d.h:115</div></div>
<div class="ttc" id="anamespaceheffte_html"><div class="ttname"><a href="namespaceheffte.html">heffte</a></div><div class="ttdoc">Namespace containing all HeFFTe methods and classes.</div><div class="ttdef"><b>Definition:</b> heffte_backend_cuda.h:38</div></div>
<div class="ttc" id="anamespaceheffte_html_a13b555103303ed58158f21210a1a3ecd"><div class="ttname"><a href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">heffte::convert_to_standard</a></div><div class="ttdeci">define_standard_type&lt; scalar_type &gt;::type * convert_to_standard(scalar_type input[])</div><div class="ttdoc">Converts an array of some type to an array of the C++ equivalent type.</div><div class="ttdef"><b>Definition:</b> heffte_utils.h:354</div></div>
<div class="ttc" id="astructheffte_1_1backend_1_1buffer__traits_html"><div class="ttname"><a href="structheffte_1_1backend_1_1buffer__traits.html">heffte::backend::buffer_traits</a></div><div class="ttdoc">Defines the container for the temporary buffers.</div><div class="ttdef"><b>Definition:</b> heffte_common.h:212</div></div>
<div class="ttc" id="astructheffte_1_1backend_1_1buffer__traits_html_a086cd1f9f7b4d1c4aacbf4c312a9d839"><div class="ttname"><a href="structheffte_1_1backend_1_1buffer__traits.html#a086cd1f9f7b4d1c4aacbf4c312a9d839">heffte::backend::buffer_traits::location</a></div><div class="ttdeci">tag::cpu location</div><div class="ttdoc">Tags the raw-array location tag::cpu or tag::gpu, used by the packers.</div><div class="ttdef"><b>Definition:</b> heffte_common.h:214</div></div>
<div class="ttc" id="astructheffte_1_1backend_1_1check__types_html"><div class="ttname"><a href="structheffte_1_1backend_1_1check__types.html">heffte::backend::check_types</a></div><div class="ttdoc">Set to true/false type depending whether the types are compatible with the backend transform.</div><div class="ttdef"><b>Definition:</b> heffte_common.h:395</div></div>
<div class="ttc" id="astructheffte_1_1backend_1_1device__instance_html"><div class="ttname"><a href="structheffte_1_1backend_1_1device__instance.html">heffte::backend::device_instance</a></div><div class="ttdoc">Holds the auxiliary variables needed by each backend.</div><div class="ttdef"><b>Definition:</b> heffte_common.h:358</div></div>
<div class="ttc" id="astructheffte_1_1backend_1_1device__instance_html_a2b63f0b1deb23636cee0bfc94ffb564c"><div class="ttname"><a href="structheffte_1_1backend_1_1device__instance.html#a2b63f0b1deb23636cee0bfc94ffb564c">heffte::backend::device_instance::stream_type</a></div><div class="ttdeci">void * stream_type</div><div class="ttdoc">The type for the internal stream, the cpu uses just a void pointer.</div><div class="ttdef"><b>Definition:</b> heffte_common.h:370</div></div>
<div class="ttc" id="astructheffte_1_1backend_1_1device__instance_html_a50b2c89b7100872ab6c704d3e4fb375e"><div class="ttname"><a href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">heffte::backend::device_instance&lt; backend::buffer_traits&lt; backend_tag &gt;::location &gt;::stream</a></div><div class="ttdeci">void * stream()</div><div class="ttdoc">Returns the nullptr.</div><div class="ttdef"><b>Definition:</b> heffte_common.h:364</div></div>
<div class="ttc" id="astructheffte_1_1backend_1_1device__instance_html_a641aa853208673ca6458c1f9cfecc01c"><div class="ttname"><a href="structheffte_1_1backend_1_1device__instance.html#a641aa853208673ca6458c1f9cfecc01c">heffte::backend::device_instance&lt; backend::buffer_traits&lt; backend_tag &gt;::location &gt;::device_instance</a></div><div class="ttdeci">device_instance(void *=nullptr)</div><div class="ttdoc">Empty constructor.</div><div class="ttdef"><b>Definition:</b> heffte_common.h:360</div></div>
<div class="ttc" id="astructheffte_1_1backend_1_1is__enabled_html"><div class="ttname"><a href="structheffte_1_1backend_1_1is__enabled.html">heffte::backend::is_enabled</a></div><div class="ttdoc">Allows to define whether a specific backend interface has been enabled.</div><div class="ttdef"><b>Definition:</b> heffte_common.h:201</div></div>
<div class="ttc" id="astructheffte_1_1backend_1_1uses__fft__types_html"><div class="ttname"><a href="structheffte_1_1backend_1_1uses__fft__types.html">heffte::backend::uses_fft_types</a></div><div class="ttdoc">Defines whether the backend accepts the standard FFT real-complex or complex-complex transform.</div><div class="ttdef"><b>Definition:</b> heffte_common.h:389</div></div>
<div class="ttc" id="astructheffte_1_1box3d_html"><div class="ttname"><a href="structheffte_1_1box3d.html">heffte::box3d</a></div><div class="ttdoc">A generic container that describes a 3d box of indexes.</div><div class="ttdef"><b>Definition:</b> heffte_geometry.h:67</div></div>
<div class="ttc" id="astructheffte_1_1fft__output_3_01double_01_4_html_afc4e0ad32ebd79081386c433791d6c00"><div class="ttname"><a href="structheffte_1_1fft__output_3_01double_01_4.html#afc4e0ad32ebd79081386c433791d6c00">heffte::fft_output&lt; double &gt;::type</a></div><div class="ttdeci">std::complex&lt; double &gt; type</div><div class="ttdoc">The output for a double data is std::complex&lt;double&gt;</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:76</div></div>
<div class="ttc" id="astructheffte_1_1fft__output_3_01float_01_4_html_a17f0c7d62bb0347315048ffd73bad5c0"><div class="ttname"><a href="structheffte_1_1fft__output_3_01float_01_4.html#a17f0c7d62bb0347315048ffd73bad5c0">heffte::fft_output&lt; float &gt;::type</a></div><div class="ttdeci">std::complex&lt; float &gt; type</div><div class="ttdoc">The output for a float data is std::complex&lt;float&gt;</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:68</div></div>
<div class="ttc" id="astructheffte_1_1fft__output_html"><div class="ttname"><a href="structheffte_1_1fft__output.html">heffte::fft_output</a></div><div class="ttdoc">Defines the relationship between pairs of input-output types in the FFT algorithms.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:58</div></div>
<div class="ttc" id="astructheffte_1_1fft__output_html_a6fa9044617b21efd39ef2ee93dde6d94"><div class="ttname"><a href="structheffte_1_1fft__output.html#a6fa9044617b21efd39ef2ee93dde6d94">heffte::fft_output::type</a></div><div class="ttdeci">scalar_type type</div><div class="ttdoc">The output type corresponding to the scalar_type.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:60</div></div>
<div class="ttc" id="astructheffte_1_1is__ccomplex_html"><div class="ttname"><a href="structheffte_1_1is__ccomplex.html">heffte::is_ccomplex</a></div><div class="ttdoc">Struct to specialize to allow HeFFTe to recognize custom single precision complex types.</div><div class="ttdef"><b>Definition:</b> heffte_utils.h:251</div></div>
<div class="ttc" id="astructheffte_1_1is__zcomplex_html"><div class="ttname"><a href="structheffte_1_1is__zcomplex.html">heffte::is_zcomplex</a></div><div class="ttdoc">Struct to specialize to allow HeFFTe to recognize custom double precision complex types.</div><div class="ttdef"><b>Definition:</b> heffte_utils.h:269</div></div>
<div class="ttc" id="astructheffte_1_1logic__plan3d_html"><div class="ttname"><a href="structheffte_1_1logic__plan3d.html">heffte::logic_plan3d</a></div><div class="ttdoc">The logic plan incorporates the order and types of operations in a transform.</div><div class="ttdef"><b>Definition:</b> heffte_plan_logic.h:275</div></div>
<div class="ttc" id="astructheffte_1_1one__dim__backend_html"><div class="ttname"><a href="structheffte_1_1one__dim__backend.html">heffte::one_dim_backend</a></div><div class="ttdoc">Indicates the structure that will be used by the fft backend.</div><div class="ttdef"><b>Definition:</b> heffte_common.h:546</div></div>
<div class="ttc" id="astructheffte_1_1plan__options_html"><div class="ttname"><a href="structheffte_1_1plan__options.html">heffte::plan_options</a></div><div class="ttdoc">Defines a set of tweaks and options to use in the plan generation.</div><div class="ttdef"><b>Definition:</b> heffte_plan_logic.h:131</div></div>
<div class="ttc" id="astructheffte_1_1tag_1_1cpu_html"><div class="ttname"><a href="structheffte_1_1tag_1_1cpu.html">heffte::tag::cpu</a></div><div class="ttdoc">Indicates the use of cpu backend and that all input/output data and arrays will be bound to the cpu.</div><div class="ttdef"><b>Definition:</b> heffte_common.h:38</div></div>
<div class="ttc" id="astructheffte_1_1transform__output_3_01scalar__type_00_01backend__tag_00_01typename_01std_1_1enab4657b516353cb2b2964ad38c40dce9ef_html_a4a8cd13f8d1e7931e959c0a07d43d01e"><div class="ttname"><a href="structheffte_1_1transform__output_3_01scalar__type_00_01backend__tag_00_01typename_01std_1_1enab4657b516353cb2b2964ad38c40dce9ef.html#a4a8cd13f8d1e7931e959c0a07d43d01e">heffte::transform_output&lt; scalar_type, backend_tag, typename std::enable_if&lt; not backend::uses_fft_types&lt; backend_tag &gt;::value &gt;::type &gt;::type</a></div><div class="ttdeci">scalar_type type</div><div class="ttdoc">The output type corresponding to the scalar_type and backend_tag (Cosine Transform case).</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:103</div></div>
<div class="ttc" id="astructheffte_1_1transform__output_3_01scalar__type_00_01backend__tag_00_01typename_01std_1_1enab68ec9eb0046c8bf0dddff44974913856_html_af3e40642e49bcfc1ba180463a6b658b3"><div class="ttname"><a href="structheffte_1_1transform__output_3_01scalar__type_00_01backend__tag_00_01typename_01std_1_1enab68ec9eb0046c8bf0dddff44974913856.html#af3e40642e49bcfc1ba180463a6b658b3">heffte::transform_output&lt; scalar_type, backend_tag, typename std::enable_if&lt; backend::uses_fft_types&lt; backend_tag &gt;::value &gt;::type &gt;::type</a></div><div class="ttdeci">typename fft_output&lt; scalar_type &gt;::type type</div><div class="ttdoc">The output type corresponding to the scalar_type and backend_tag (FFT case).</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:94</div></div>
<div class="ttc" id="astructheffte_1_1transform__output_html"><div class="ttname"><a href="structheffte_1_1transform__output.html">heffte::transform_output</a></div><div class="ttdoc">Defines the relationship between pairs of input-output types in a general transform algorithm.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:86</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><b>heffte_fft3d.h</b></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
