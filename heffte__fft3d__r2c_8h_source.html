<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Highly Efficient FFT for Exascale: HeFFTe v2.3: include/heffte_fft3d_r2c.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="heffte.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Highly Efficient FFT for Exascale: HeFFTe v2.3
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('heffte__fft3d__r2c_8h_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">heffte_fft3d_r2c.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">    -- heFFTe --</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">       Univ. of Tennessee, Knoxville</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">       @date</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160; </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#ifndef HEFFTE_FFT3D_R2C_H</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#define HEFFTE_FFT3D_R2C_H</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;heffte_fft3d.h&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceheffte.html">heffte</a> {</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> backend_tag, <span class="keyword">typename</span> index = <span class="keywordtype">int</span>&gt;</div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html">   46</a></span>&#160;<span class="keyword">class </span><a class="code" href="classheffte_1_1fft3d__r2c.html">fft3d_r2c</a> : <span class="keyword">public</span> <a class="code" href="structheffte_1_1backend_1_1device__instance.html">backend::device_instance</a>&lt;typename backend::buffer_traits&lt;backend_tag&gt;::location&gt;{</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#ac5645b0d98a5ede0971e012ea5ffbb6e">   49</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#ac5645b0d98a5ede0971e012ea5ffbb6e">backend_executor_c2c</a> = <span class="keyword">typename</span> <a class="code" href="structheffte_1_1one__dim__backend.html">one_dim_backend&lt;backend_tag&gt;::executor</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#a502ebe301e32c1c5d899283a41d4cdcc">   51</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#a502ebe301e32c1c5d899283a41d4cdcc">backend_executor_r2c</a> = <span class="keyword">typename</span> <a class="code" href="structheffte_1_1one__dim__backend.html">one_dim_backend&lt;backend_tag&gt;::executor_r2c</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#a710727c09ba32ac473cf35397e26c7ed">   55</a></span>&#160;    <span class="keyword">using</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#a710727c09ba32ac473cf35397e26c7ed">location_tag</a> = <span class="keyword">typename</span> <a class="code" href="structheffte_1_1tag_1_1cpu.html">backend::buffer_traits&lt;backend_tag&gt;::location</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#a2e1fefb8e5013f31d48fd9dcdd793bc8">   60</a></span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">using</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#a2e1fefb8e5013f31d48fd9dcdd793bc8">buffer_container</a> = <span class="keyword">typename</span> <a class="code" href="structheffte_1_1backend_1_1buffer__traits.html">backend::buffer_traits&lt;backend_tag&gt;::template</a> container&lt;T&gt;;</div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#a0e288866564e7d12287ec95695aeacec">   62</a></span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">using</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#a0e288866564e7d12287ec95695aeacec">real_buffer_container</a> = <a class="code" href="classheffte_1_1fft3d__r2c.html#a2e1fefb8e5013f31d48fd9dcdd793bc8">buffer_container&lt;typename define_standard_type&lt;T&gt;::type::value_type</a>&gt;;</div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#a803ee1cf1616c08ab5ff2808a18b1314">   64</a></span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="keyword">using</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#a803ee1cf1616c08ab5ff2808a18b1314">output_buffer_container</a> = <a class="code" href="classheffte_1_1fft3d__r2c.html#a2e1fefb8e5013f31d48fd9dcdd793bc8">buffer_container&lt;typename fft_output&lt;T&gt;::type</a>&gt;;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#a706872c1cfa90729d33198c758b64e36">   76</a></span>&#160;    <a class="code" href="classheffte_1_1fft3d__r2c.html#a706872c1cfa90729d33198c758b64e36">fft3d_r2c</a>(<a class="code" href="structheffte_1_1box3d.html">box3d&lt;index&gt;</a> <span class="keyword">const</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#aacdb9a0139472559916612be1a706456">inbox</a>, <a class="code" href="structheffte_1_1box3d.html">box3d&lt;index&gt;</a> <span class="keyword">const</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#ac42aa3f5477ba6ff92fe21cc174aa4a8">outbox</a>, <span class="keywordtype">int</span> r2c_direction, MPI_Comm <span class="keyword">const</span> comm,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;              <a class="code" href="structheffte_1_1plan__options.html">plan_options</a> <span class="keyword">const</span> options = default_options&lt;backend_tag&gt;()) :</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <a class="code" href="classheffte_1_1fft3d__r2c.html">fft3d_r2c</a>(<a class="code" href="group__fft3dplan.html#gadfe5ddda96e7aecb88edc7aeb07dbc91">plan_operations</a>(mpi::<a class="code" href="group__hefftempi.html#gacade914d344f3727d9e7d8dcfd13ed5a">gather_boxes</a>(<a class="code" href="classheffte_1_1fft3d__r2c.html#aacdb9a0139472559916612be1a706456">inbox</a>, <a class="code" href="classheffte_1_1fft3d__r2c.html#ac42aa3f5477ba6ff92fe21cc174aa4a8">outbox</a>, comm), r2c_direction, <a class="code" href="group__fft3d.html#ga8c2c4b54da75fafbe68b3115d4390a66">set_options</a>&lt;backend_tag, true&gt;(options), mpi::<a class="code" href="group__hefftempi.html#ga5df7514ec8acb2b7bcc642892ed22f67">comm_rank</a>(comm)), comm){</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        assert(r2c_direction == 0 or r2c_direction == 1 or r2c_direction == 2);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        static_assert(<a class="code" href="structheffte_1_1backend_1_1is__enabled.html">backend::is_enabled&lt;backend_tag&gt;::value</a>, <span class="stringliteral">&quot;The requested backend is invalid or has not been enabled.&quot;</span>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#a62ed62a314613f5ccf8fb05df46af4d7">   85</a></span>&#160;    <a class="code" href="classheffte_1_1fft3d__r2c.html#a62ed62a314613f5ccf8fb05df46af4d7">fft3d_r2c</a>(<span class="keyword">typename</span> <a class="code" href="structheffte_1_1backend_1_1device__instance.html#a2b63f0b1deb23636cee0bfc94ffb564c">backend::device_instance&lt;location_tag&gt;::stream_type</a> gpu_stream,</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;              <a class="code" href="structheffte_1_1box3d.html">box3d&lt;index&gt;</a> <span class="keyword">const</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#aacdb9a0139472559916612be1a706456">inbox</a>, <a class="code" href="structheffte_1_1box3d.html">box3d&lt;index&gt;</a> <span class="keyword">const</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#ac42aa3f5477ba6ff92fe21cc174aa4a8">outbox</a>, <span class="keywordtype">int</span> r2c_direction, MPI_Comm <span class="keyword">const</span> comm,</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;              <a class="code" href="structheffte_1_1plan__options.html">plan_options</a> <span class="keyword">const</span> options = default_options&lt;backend_tag&gt;()) :</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <a class="code" href="classheffte_1_1fft3d__r2c.html">fft3d_r2c</a>(gpu_stream,</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                  <a class="code" href="group__fft3dplan.html#gadfe5ddda96e7aecb88edc7aeb07dbc91">plan_operations</a>(mpi::<a class="code" href="group__hefftempi.html#gacade914d344f3727d9e7d8dcfd13ed5a">gather_boxes</a>(<a class="code" href="classheffte_1_1fft3d__r2c.html#aacdb9a0139472559916612be1a706456">inbox</a>, <a class="code" href="classheffte_1_1fft3d__r2c.html#ac42aa3f5477ba6ff92fe21cc174aa4a8">outbox</a>, comm), r2c_direction, <a class="code" href="group__fft3d.html#ga8c2c4b54da75fafbe68b3115d4390a66">set_options</a>&lt;backend_tag, true&gt;(options), mpi::<a class="code" href="group__hefftempi.html#ga5df7514ec8acb2b7bcc642892ed22f67">comm_rank</a>(comm)),</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                  comm){</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        assert(r2c_direction == 0 or r2c_direction == 1 or r2c_direction == 2);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        static_assert(<a class="code" href="structheffte_1_1backend_1_1is__enabled.html">backend::is_enabled&lt;backend_tag&gt;::value</a>, <span class="stringliteral">&quot;The requested backend is invalid or has not been enabled.&quot;</span>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#a14f987b10e60be6d65cb875b711065b6">   96</a></span>&#160;    <a class="code" href="classheffte_1_1fft3d__r2c.html#a14f987b10e60be6d65cb875b711065b6">fft3d_r2c</a>(<span class="keywordtype">int</span> il0, <span class="keywordtype">int</span> il1, <span class="keywordtype">int</span> il2, <span class="keywordtype">int</span> ih0, <span class="keywordtype">int</span> ih1, <span class="keywordtype">int</span> ih2, <span class="keywordtype">int</span> io0, <span class="keywordtype">int</span> io1, <span class="keywordtype">int</span> io2,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;              <span class="keywordtype">int</span> ol0, <span class="keywordtype">int</span> ol1, <span class="keywordtype">int</span> ol2, <span class="keywordtype">int</span> oh0, <span class="keywordtype">int</span> oh1, <span class="keywordtype">int</span> oh2, <span class="keywordtype">int</span> oo0, <span class="keywordtype">int</span> oo1, <span class="keywordtype">int</span> oo2,</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;              <span class="keywordtype">int</span> r2c_direction, MPI_Comm <span class="keyword">const</span> comm,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;              <span class="keywordtype">bool</span> use_reorder, <span class="keywordtype">int</span> algorithm, <span class="keywordtype">bool</span> use_pencils)</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        : <a class="code" href="classheffte_1_1fft3d__r2c.html">fft3d_r2c</a>(<a class="code" href="structheffte_1_1box3d.html">box3d</a>&lt;index&gt;({il0, il1, il2}, {ih0, ih1, ih2}, {io0, io1, io2}),</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                    box3d&lt;index&gt;({ol0, ol1, ol2}, {oh0, oh1, oh2}, {oo0, oo1, oo2}),</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                    r2c_direction, comm,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                plan_options(use_reorder, <span class="keyword">static_cast&lt;</span><a class="code" href="group__fft3d.html#ga4c9d07a6600d0e32939ec064c0604767">reshape_algorithm</a><span class="keyword">&gt;</span>(algorithm), use_pencils))</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    {}</div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#adf785e117680189b229963adc3435ddf">  106</a></span>&#160;    <a class="code" href="classheffte_1_1fft3d__r2c.html#adf785e117680189b229963adc3435ddf">fft3d_r2c</a>(<span class="keywordtype">int</span> il0, <span class="keywordtype">int</span> il1, <span class="keywordtype">int</span> il2, <span class="keywordtype">int</span> ih0, <span class="keywordtype">int</span> ih1, <span class="keywordtype">int</span> ih2, <span class="keywordtype">int</span> io0, <span class="keywordtype">int</span> io1, <span class="keywordtype">int</span> io2,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;              <span class="keywordtype">int</span> ol0, <span class="keywordtype">int</span> ol1, <span class="keywordtype">int</span> ol2, <span class="keywordtype">int</span> oh0, <span class="keywordtype">int</span> oh1, <span class="keywordtype">int</span> oh2, <span class="keywordtype">int</span> oo0, <span class="keywordtype">int</span> oo1, <span class="keywordtype">int</span> oo2,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;              <span class="keywordtype">int</span> r2c_direction, MPI_Comm <span class="keyword">const</span> comm)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        : <a class="code" href="classheffte_1_1fft3d__r2c.html">fft3d_r2c</a>(<a class="code" href="structheffte_1_1box3d.html">box3d</a>&lt;index&gt;({il0, il1, il2}, {ih0, ih1, ih2}, {io0, io1, io2}),</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                    box3d&lt;index&gt;({ol0, ol1, ol2}, {oh0, oh1, oh2}, {oo0, oo1, oo2}),</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                    r2c_direction, comm)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    {}</div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#aa6010dba665d7a36aabb015b4048dd79">  114</a></span>&#160;    <a class="code" href="classheffte_1_1fft3d__r2c.html#aa6010dba665d7a36aabb015b4048dd79">fft3d_r2c</a>(<span class="keywordtype">int</span> il0, <span class="keywordtype">int</span> il1, <span class="keywordtype">int</span> il2, <span class="keywordtype">int</span> ih0, <span class="keywordtype">int</span> ih1, <span class="keywordtype">int</span> ih2,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;              <span class="keywordtype">int</span> ol0, <span class="keywordtype">int</span> ol1, <span class="keywordtype">int</span> ol2, <span class="keywordtype">int</span> oh0, <span class="keywordtype">int</span> oh1, <span class="keywordtype">int</span> oh2,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;              <span class="keywordtype">int</span> r2c_direction, MPI_Comm <span class="keyword">const</span> comm)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        : <a class="code" href="classheffte_1_1fft3d__r2c.html">fft3d_r2c</a>(<a class="code" href="structheffte_1_1box3d.html">box3d</a>&lt;index&gt;({il0, il1, il2}, {ih0, ih1, ih2}), box3d&lt;index&gt;({ol0, ol1, ol2}, {oh0, oh1, oh2}), r2c_direction, comm)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    {}</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#a66b79723f78cf9f1ea5d2b00b217b3f8">  121</a></span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#a66b79723f78cf9f1ea5d2b00b217b3f8">size_inbox</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> pinbox-&gt;count(); }</div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#a7d381ece929d12ae10e660951aa039f8">  123</a></span>&#160;    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#a7d381ece929d12ae10e660951aa039f8">size_outbox</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> poutbox-&gt;count(); }</div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#aacdb9a0139472559916612be1a706456">  125</a></span>&#160;    <a class="code" href="structheffte_1_1box3d.html">box3d&lt;index&gt;</a> <a class="code" href="classheffte_1_1fft3d__r2c.html#aacdb9a0139472559916612be1a706456">inbox</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> *pinbox; }</div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#ac42aa3f5477ba6ff92fe21cc174aa4a8">  127</a></span>&#160;    <a class="code" href="structheffte_1_1box3d.html">box3d&lt;index&gt;</a> <a class="code" href="classheffte_1_1fft3d__r2c.html#ac42aa3f5477ba6ff92fe21cc174aa4a8">outbox</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> *poutbox; }</div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#addbfb7d7962acad1c0e66faefdb68381">  129</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#addbfb7d7962acad1c0e66faefdb68381">size_workspace</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> size_buffer_work; }</div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#a3889e71b801a226cc5b2c6a55dce6102">  131</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#a3889e71b801a226cc5b2c6a55dce6102">size_comm_buffers</a>()<span class="keyword"> const</span>{ <span class="keywordflow">return</span> comm_buffer_offset; }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> input_type, <span class="keyword">typename</span> output_type&gt;</div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#a1dc0b7c454e98b0905e614030f88dcc9">  147</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#a1dc0b7c454e98b0905e614030f88dcc9">forward</a>(input_type <span class="keyword">const</span> input[], output_type output[], <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling = <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        static_assert((std::is_same&lt;input_type, float&gt;::value and <a class="code" href="structheffte_1_1is__ccomplex.html">is_ccomplex&lt;output_type&gt;::value</a>)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                   or (std::is_same&lt;input_type, double&gt;::value and <a class="code" href="structheffte_1_1is__zcomplex.html">is_zcomplex&lt;output_type&gt;::value</a>),</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                <span class="stringliteral">&quot;Using either an unknown complex type or an incompatible pair of types!&quot;</span>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keyword">auto</span> workspace = make_buffer_container&lt;output_type&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), <a class="code" href="classheffte_1_1fft3d__r2c.html#addbfb7d7962acad1c0e66faefdb68381">size_workspace</a>());</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <a class="code" href="classheffte_1_1fft3d__r2c.html#a1dc0b7c454e98b0905e614030f88dcc9">forward</a>(input, output, workspace.data(), scaling);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> input_type, <span class="keyword">typename</span> output_type&gt;</div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#add193030468b3c59c90cad8d628c5877">  158</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#add193030468b3c59c90cad8d628c5877">forward</a>(input_type <span class="keyword">const</span> input[], output_type output[], output_type workspace[], <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling = <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        static_assert((std::is_same&lt;input_type, float&gt;::value and <a class="code" href="structheffte_1_1is__ccomplex.html">is_ccomplex&lt;output_type&gt;::value</a>)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                   or (std::is_same&lt;input_type, double&gt;::value and <a class="code" href="structheffte_1_1is__zcomplex.html">is_zcomplex&lt;output_type&gt;::value</a>),</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                <span class="stringliteral">&quot;Using either an unknown complex type or an incompatible pair of types!&quot;</span>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        compute_transform&lt;location_tag, index&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), 1, <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(input), <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(output),</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                               <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(workspace),</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                               executor_buffer_offset, <a class="code" href="classheffte_1_1fft3d__r2c.html#a3889e71b801a226cc5b2c6a55dce6102">size_comm_buffers</a>(), forward_shaper,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                               forward_executors(), <a class="code" href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a965dbaac085fc891bfbbd4f9d145bbc8">direction::forward</a>);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        apply_scale(1, <a class="code" href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a965dbaac085fc891bfbbd4f9d145bbc8">direction::forward</a>, scaling, output);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> input_type, <span class="keyword">typename</span> output_type&gt;</div>
<div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#a8f35d3e08a3308f403ce9f7c50118097">  171</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#a8f35d3e08a3308f403ce9f7c50118097">forward</a>(<span class="keywordtype">int</span> batch_size, input_type <span class="keyword">const</span> input[], output_type output[],</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                 output_type workspace[], <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling = <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        static_assert((std::is_same&lt;input_type, float&gt;::value and <a class="code" href="structheffte_1_1is__ccomplex.html">is_ccomplex&lt;output_type&gt;::value</a>)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                   or (std::is_same&lt;input_type, double&gt;::value and <a class="code" href="structheffte_1_1is__zcomplex.html">is_zcomplex&lt;output_type&gt;::value</a>),</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                <span class="stringliteral">&quot;Using either an unknown complex type or an incompatible pair of types!&quot;</span>);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        compute_transform&lt;location_tag, index&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), batch_size, <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(input), <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(output),</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                               <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(workspace),</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                               executor_buffer_offset, <a class="code" href="classheffte_1_1fft3d__r2c.html#a3889e71b801a226cc5b2c6a55dce6102">size_comm_buffers</a>(), forward_shaper,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                               forward_executors(), <a class="code" href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a965dbaac085fc891bfbbd4f9d145bbc8">direction::forward</a>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        apply_scale(batch_size, <a class="code" href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a965dbaac085fc891bfbbd4f9d145bbc8">direction::forward</a>, scaling, output);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> input_type, <span class="keyword">typename</span> output_type&gt;</div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#ae8050aa1c744d3e14220ae49bc685584">  185</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#ae8050aa1c744d3e14220ae49bc685584">forward</a>(<span class="keywordtype">int</span> batch_size, input_type <span class="keyword">const</span> input[], output_type output[], <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling = <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        static_assert((std::is_same&lt;input_type, float&gt;::value and <a class="code" href="structheffte_1_1is__ccomplex.html">is_ccomplex&lt;output_type&gt;::value</a>)</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                   or (std::is_same&lt;input_type, double&gt;::value and <a class="code" href="structheffte_1_1is__zcomplex.html">is_zcomplex&lt;output_type&gt;::value</a>),</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                <span class="stringliteral">&quot;Using either an unknown complex type or an incompatible pair of types!&quot;</span>);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keyword">auto</span> workspace = make_buffer_container&lt;output_type&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), batch_size * <a class="code" href="classheffte_1_1fft3d__r2c.html#addbfb7d7962acad1c0e66faefdb68381">size_workspace</a>());</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <a class="code" href="classheffte_1_1fft3d__r2c.html#a1dc0b7c454e98b0905e614030f88dcc9">forward</a>(batch_size, input, output, workspace.data(), scaling);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> input_type&gt;</div>
<div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#af2672f0565fbebf17526a269efd7809f">  211</a></span>&#160;    <a class="code" href="classheffte_1_1fft3d__r2c.html#a803ee1cf1616c08ab5ff2808a18b1314">output_buffer_container&lt;input_type&gt;</a> <a class="code" href="classheffte_1_1fft3d__r2c.html#af2672f0565fbebf17526a269efd7809f">forward</a>(<a class="code" href="classheffte_1_1fft3d__r2c.html#a2e1fefb8e5013f31d48fd9dcdd793bc8">buffer_container&lt;input_type&gt;</a> <span class="keyword">const</span> &amp;input, <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling = <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>){</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordflow">if</span> (input.size() &lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code" href="classheffte_1_1fft3d__r2c.html#a66b79723f78cf9f1ea5d2b00b217b3f8">size_inbox</a>()))</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="keywordflow">throw</span> std::invalid_argument(<span class="stringliteral">&quot;The input vector is smaller than size_inbox(), i.e., not enough entries provided to fill the inbox.&quot;</span>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        static_assert(std::is_same&lt;input_type, float&gt;::value or std::is_same&lt;input_type, double&gt;::value,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                      <span class="stringliteral">&quot;The input to forward() must be real, i.e., either float or double.&quot;</span>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keyword">auto</span> output = make_buffer_container&lt;typename fft_output&lt;input_type&gt;::type&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), <a class="code" href="classheffte_1_1fft3d__r2c.html#a7d381ece929d12ae10e660951aa039f8">size_outbox</a>());</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <a class="code" href="classheffte_1_1fft3d__r2c.html#a1dc0b7c454e98b0905e614030f88dcc9">forward</a>(input.data(), output.data(), scaling);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordflow">return</span> output;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> input_type, <span class="keyword">typename</span> output_type&gt;</div>
<div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#af655d4b64740b94c27d57c396198a0da">  235</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#af655d4b64740b94c27d57c396198a0da">backward</a>(input_type <span class="keyword">const</span> input[], output_type output[], <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling = <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        static_assert((std::is_same&lt;output_type, float&gt;::value and <a class="code" href="structheffte_1_1is__ccomplex.html">is_ccomplex&lt;input_type&gt;::value</a>)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                   or (std::is_same&lt;output_type, double&gt;::value and <a class="code" href="structheffte_1_1is__zcomplex.html">is_zcomplex&lt;input_type&gt;::value</a>),</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                <span class="stringliteral">&quot;Using either an unknown complex type or an incompatible pair of types!&quot;</span>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keyword">auto</span> workspace = make_buffer_container&lt;input_type&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), <a class="code" href="classheffte_1_1fft3d__r2c.html#addbfb7d7962acad1c0e66faefdb68381">size_workspace</a>());</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <a class="code" href="classheffte_1_1fft3d__r2c.html#af655d4b64740b94c27d57c396198a0da">backward</a>(input, output, workspace.data(), scaling);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> input_type, <span class="keyword">typename</span> output_type&gt;</div>
<div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#ae704581dc4be2201f2784234ffc2132b">  246</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#ae704581dc4be2201f2784234ffc2132b">backward</a>(input_type <span class="keyword">const</span> input[], output_type output[], input_type workspace[], <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling = <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        static_assert((std::is_same&lt;output_type, float&gt;::value and <a class="code" href="structheffte_1_1is__ccomplex.html">is_ccomplex&lt;input_type&gt;::value</a>)</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                   or (std::is_same&lt;output_type, double&gt;::value and <a class="code" href="structheffte_1_1is__zcomplex.html">is_zcomplex&lt;input_type&gt;::value</a>),</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                <span class="stringliteral">&quot;Using either an unknown complex type or an incompatible pair of types!&quot;</span>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        compute_transform&lt;location_tag, index&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), 1, <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(input), <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(output),</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                                               <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(workspace),</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                               executor_buffer_offset, <a class="code" href="classheffte_1_1fft3d__r2c.html#a3889e71b801a226cc5b2c6a55dce6102">size_comm_buffers</a>(), backward_shaper,</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                                               backward_executors(), <a class="code" href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a195fe59b6f103787a914aead0f3db502">direction::backward</a>);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        apply_scale(1, <a class="code" href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a195fe59b6f103787a914aead0f3db502">direction::backward</a>, scaling, output);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> input_type, <span class="keyword">typename</span> output_type&gt;</div>
<div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#aac0bbd227f1caf1e15c9c30b0873b463">  259</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#aac0bbd227f1caf1e15c9c30b0873b463">backward</a>(<span class="keywordtype">int</span> batch_size, input_type <span class="keyword">const</span> input[], output_type output[],</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                  input_type workspace[], <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling = <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        static_assert((std::is_same&lt;output_type, float&gt;::value and <a class="code" href="structheffte_1_1is__ccomplex.html">is_ccomplex&lt;input_type&gt;::value</a>)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                   or (std::is_same&lt;output_type, double&gt;::value and <a class="code" href="structheffte_1_1is__zcomplex.html">is_zcomplex&lt;input_type&gt;::value</a>),</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <span class="stringliteral">&quot;Using either an unknown complex type or an incompatible pair of types!&quot;</span>);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        compute_transform&lt;location_tag, index&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), batch_size, <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(input), <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(output),</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                                               <a class="code" href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">convert_to_standard</a>(workspace),</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                                               executor_buffer_offset, <a class="code" href="classheffte_1_1fft3d__r2c.html#a3889e71b801a226cc5b2c6a55dce6102">size_comm_buffers</a>(), backward_shaper,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                                               backward_executors(), <a class="code" href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a195fe59b6f103787a914aead0f3db502">direction::backward</a>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        apply_scale(batch_size, <a class="code" href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a195fe59b6f103787a914aead0f3db502">direction::backward</a>, scaling, output);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> input_type, <span class="keyword">typename</span> output_type&gt;</div>
<div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#a479ce39c4bdb0cd3eae3413f8762be5d">  273</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#a479ce39c4bdb0cd3eae3413f8762be5d">backward</a>(<span class="keywordtype">int</span> batch_size, input_type <span class="keyword">const</span> input[], output_type output[], <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling = <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        static_assert((std::is_same&lt;output_type, float&gt;::value and <a class="code" href="structheffte_1_1is__ccomplex.html">is_ccomplex&lt;input_type&gt;::value</a>)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                   or (std::is_same&lt;output_type, double&gt;::value and <a class="code" href="structheffte_1_1is__zcomplex.html">is_zcomplex&lt;input_type&gt;::value</a>),</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                <span class="stringliteral">&quot;Using either an unknown complex type or an incompatible pair of types!&quot;</span>);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="keyword">auto</span> workspace = make_buffer_container&lt;input_type&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), batch_size * <a class="code" href="classheffte_1_1fft3d__r2c.html#addbfb7d7962acad1c0e66faefdb68381">size_workspace</a>());</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <a class="code" href="classheffte_1_1fft3d__r2c.html#af655d4b64740b94c27d57c396198a0da">backward</a>(batch_size, input, output, workspace.data(), scaling);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> scalar_type&gt;</div>
<div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#aa2239b78b2554e12444facc18db15aca">  286</a></span>&#160;    <a class="code" href="classheffte_1_1fft3d__r2c.html#a0e288866564e7d12287ec95695aeacec">real_buffer_container&lt;scalar_type&gt;</a> <a class="code" href="classheffte_1_1fft3d__r2c.html#aa2239b78b2554e12444facc18db15aca">backward</a>(<a class="code" href="classheffte_1_1fft3d__r2c.html#a2e1fefb8e5013f31d48fd9dcdd793bc8">buffer_container&lt;scalar_type&gt;</a> <span class="keyword">const</span> &amp;input, <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling = <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>){</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        static_assert(<a class="code" href="structheffte_1_1is__ccomplex.html">is_ccomplex&lt;scalar_type&gt;::value</a> or <a class="code" href="structheffte_1_1is__zcomplex.html">is_zcomplex&lt;scalar_type&gt;::value</a>,</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                      <span class="stringliteral">&quot;Either calling backward() with non-complex input or using an unknown complex type.&quot;</span>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keyword">auto</span> result = make_buffer_container&lt;typename define_standard_type&lt;scalar_type&gt;::type::value_type&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), <a class="code" href="classheffte_1_1fft3d__r2c.html#a66b79723f78cf9f1ea5d2b00b217b3f8">size_inbox</a>());</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <a class="code" href="classheffte_1_1fft3d__r2c.html#af655d4b64740b94c27d57c396198a0da">backward</a>(input.data(), result.data(), scaling);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="classheffte_1_1fft3d__r2c.html#af04c79cb99789e7a28d7e9bd919f705d">  297</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classheffte_1_1fft3d__r2c.html#af04c79cb99789e7a28d7e9bd919f705d">get_scale_factor</a>(<a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling)<span class="keyword"> const</span>{ <span class="keywordflow">return</span> (scaling == <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cbafeca3c730601be7fd57f1f0b668b4637">scale::symmetric</a>) ? std::sqrt(scale_factor) : scale_factor; }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <a class="code" href="classheffte_1_1fft3d__r2c.html#a706872c1cfa90729d33198c758b64e36">fft3d_r2c</a>(<a class="code" href="structheffte_1_1logic__plan3d.html">logic_plan3d&lt;index&gt;</a> <span class="keyword">const</span> &amp;plan, MPI_Comm <span class="keyword">const</span> comm) :</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        pinbox(new <a class="code" href="structheffte_1_1box3d.html">box3d</a>&lt;index&gt;(plan.in_shape[0][plan.mpi_rank])), poutbox(new <a class="code" href="structheffte_1_1box3d.html">box3d</a>&lt;index&gt;(plan.out_shape[3][plan.mpi_rank])),</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        scale_factor(1.0 / static_cast&lt;double&gt;(plan.index_count))</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        #ifdef Heffte_ENABLE_MAGMA</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        , hmagma(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>())</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        #endif</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        setup(plan, comm);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="classheffte_1_1fft3d__r2c.html#a706872c1cfa90729d33198c758b64e36">fft3d_r2c</a>(<span class="keyword">typename</span> <a class="code" href="structheffte_1_1backend_1_1device__instance.html#a2b63f0b1deb23636cee0bfc94ffb564c">backend::device_instance&lt;location_tag&gt;::stream_type</a> gpu_stream,</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;              logic_plan3d&lt;index&gt; <span class="keyword">const</span> &amp;plan, MPI_Comm <span class="keyword">const</span> comm) :</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        backend::<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a641aa853208673ca6458c1f9cfecc01c">device_instance</a>&lt;<a class="code" href="classheffte_1_1fft3d__r2c.html#a710727c09ba32ac473cf35397e26c7ed">location_tag</a>&gt;(gpu_stream),</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        pinbox(new box3d&lt;index&gt;(plan.in_shape[0][plan.mpi_rank])), poutbox(new box3d&lt;index&gt;(plan.out_shape[3][plan.mpi_rank])),</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        scale_factor(1.0 / static_cast&lt;double&gt;(plan.index_count))</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        #ifdef Heffte_ENABLE_MAGMA</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        , hmagma(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>())</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        #endif</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        setup(plan, comm);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordtype">void</span> setup(logic_plan3d&lt;index&gt; <span class="keyword">const</span> &amp;plan, MPI_Comm <span class="keyword">const</span> comm){</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;4; i++){</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            forward_shaper[i]    = make_reshape3d&lt;backend_tag&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), plan.in_shape[i], plan.out_shape[i], comm, plan.options);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            backward_shaper[3-i] = make_reshape3d&lt;backend_tag&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), plan.out_shape[i], plan.in_shape[i], comm, plan.options);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        executors[0] = make_executor_r2c&lt;backend_tag&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), plan.out_shape[0][<a class="code" href="group__hefftempi.html#ga5df7514ec8acb2b7bcc642892ed22f67">mpi::comm_rank</a>(comm)], plan.fft_direction[0]);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        executors[1] = make_executor&lt;backend_tag&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), plan.out_shape[1][<a class="code" href="group__hefftempi.html#ga5df7514ec8acb2b7bcc642892ed22f67">mpi::comm_rank</a>(comm)], plan.fft_direction[1]);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        executors[2] = make_executor&lt;backend_tag&gt;(this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(), plan.out_shape[2][<a class="code" href="group__hefftempi.html#ga5df7514ec8acb2b7bcc642892ed22f67">mpi::comm_rank</a>(comm)], plan.fft_direction[2]);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordtype">size_t</span> executor_workspace_size = <a class="code" href="group__fft3dmisc.html#gaf5806a52f52a1dd1b316d52e742b187c">get_max_work_size</a>(executors);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        comm_buffer_offset = std::max(<a class="code" href="group__hefftereshape.html#gadd1dabaa0d659f85b6c882c2a14cd895">get_workspace_size</a>(forward_shaper), <a class="code" href="group__hefftereshape.html#gadd1dabaa0d659f85b6c882c2a14cd895">get_workspace_size</a>(backward_shaper));</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        size_buffer_work = comm_buffer_offset</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                        + <a class="code" href="group__fft3dmisc.html#ga45476ceb85f91090541c53ac322b06b2">get_max_box_size_r2c</a>(executors) + executor_workspace_size;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        executor_buffer_offset = (executor_workspace_size == 0) ? 0 : size_buffer_work - executor_workspace_size;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    std::array&lt;executor_base*, 3&gt; forward_executors()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordflow">return</span> std::array&lt;executor_base*, 3&gt;{executors[0].get(), executors[1].get(), executors[2].get()};</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    std::array&lt;executor_base*, 3&gt; backward_executors()<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordflow">return</span> std::array&lt;executor_base*, 3&gt;{executors[2].get(), executors[1].get(), executors[0].get()};</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> scalar_type&gt;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordtype">void</span> apply_scale(<span class="keywordtype">int</span> <span class="keyword">const</span> batch_size, <a class="code" href="group__fft3dmisc.html#ga2738b0dcfd330cf26181036ee5133a09">direction</a> dir, <a class="code" href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">scale</a> scaling, scalar_type data[])<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="keywordflow">if</span> (scaling != <a class="code" href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">scale::none</a>){</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            add_trace <a class="code" href="group__fft3dbackend.html#ga65d6597fd795ca487089c90a6052afab">name</a>(<span class="stringliteral">&quot;scale&quot;</span>);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="preprocessor">            #ifdef Heffte_ENABLE_MAGMA</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <span class="keywordflow">if</span> (std::is_same&lt;location_tag, tag::gpu&gt;::value){</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                hmagma.scal(batch_size * (dir == <a class="code" href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a965dbaac085fc891bfbbd4f9d145bbc8">direction::forward</a>) ? <a class="code" href="classheffte_1_1fft3d__r2c.html#a7d381ece929d12ae10e660951aa039f8">size_outbox</a>() : <a class="code" href="classheffte_1_1fft3d__r2c.html#a66b79723f78cf9f1ea5d2b00b217b3f8">size_inbox</a>(), <a class="code" href="classheffte_1_1fft3d__r2c.html#af04c79cb99789e7a28d7e9bd919f705d">get_scale_factor</a>(scaling), data);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="preprocessor">            #endif</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <a class="code" href="group__hefftecuda.html#ga2b39bc4364fc371a804e17238b7ac566">data_scaling::apply</a>(</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                this-&gt;<a class="code" href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">stream</a>(),</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                batch_size * ((dir == <a class="code" href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a965dbaac085fc891bfbbd4f9d145bbc8">direction::forward</a>) ? <a class="code" href="classheffte_1_1fft3d__r2c.html#a7d381ece929d12ae10e660951aa039f8">size_outbox</a>() : <a class="code" href="classheffte_1_1fft3d__r2c.html#a66b79723f78cf9f1ea5d2b00b217b3f8">size_inbox</a>()),</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                data, <a class="code" href="classheffte_1_1fft3d__r2c.html#af04c79cb99789e7a28d7e9bd919f705d">get_scale_factor</a>(scaling));</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    std::unique_ptr&lt;box3d&lt;index&gt;&gt; pinbox, poutbox;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordtype">double</span> scale_factor;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    std::array&lt;std::unique_ptr&lt;reshape3d_base&lt;index&gt;&gt;, 4&gt; forward_shaper;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    std::array&lt;std::unique_ptr&lt;reshape3d_base&lt;index&gt;&gt;, 4&gt; backward_shaper;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    std::array&lt;std::unique_ptr&lt;executor_base&gt;, 3&gt; executors;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="preprocessor">    #ifdef Heffte_ENABLE_MAGMA</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    gpu::magma_handle&lt;location_tag&gt; hmagma;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor">    #endif</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">// cache some values for faster read</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordtype">size_t</span> size_buffer_work, comm_buffer_offset, executor_buffer_offset;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;};</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> backend_tag, <span class="keyword">typename</span> index = <span class="keywordtype">int</span>&gt;</div>
<div class="line"><a name="l00387"></a><span class="lineno"><a class="line" href="group__fft3d.html#gae405e39f93560a5dcb99493ca395f485">  387</a></span>&#160;<span class="keyword">using</span> <a class="code" href="classheffte_1_1fft3d__r2c.html">fft2d_r2c</a> = <a class="code" href="classheffte_1_1fft3d__r2c.html">fft3d_r2c&lt;backend_tag, index&gt;</a>;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> backend_tag, <span class="keyword">typename</span> index&gt;</div>
<div class="line"><a name="l00394"></a><span class="lineno"><a class="line" href="group__fft3d.html#gadb4e1668dd7bca515ed42c91d1846dd7">  394</a></span>&#160;<a class="code" href="classheffte_1_1fft3d__r2c.html">fft3d_r2c&lt;backend_tag, index&gt;</a> <a class="code" href="group__fft3d.html#gadb4e1668dd7bca515ed42c91d1846dd7">make_fft3d_r2c</a>(<a class="code" href="structheffte_1_1box3d.html">box3d&lt;index&gt;</a> <span class="keyword">const</span> inbox, <a class="code" href="structheffte_1_1box3d.html">box3d&lt;index&gt;</a> <span class="keyword">const</span> outbox,</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                                             <span class="keywordtype">int</span> r2c_direction, MPI_Comm <span class="keyword">const</span> comm,</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                                             <a class="code" href="structheffte_1_1plan__options.html">plan_options</a> <span class="keyword">const</span> options = default_options&lt;backend_tag&gt;()){</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    static_assert(std::is_same&lt;index, int&gt;::value or std::is_same&lt;index, long long&gt;::value,</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                  <span class="stringliteral">&quot;heFFTe works with &#39;int&#39; and &#39;long long&#39; indexing only&quot;</span>);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    static_assert(<a class="code" href="structheffte_1_1backend_1_1is__enabled.html">backend::is_enabled&lt;backend_tag&gt;::value</a>,</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                  <span class="stringliteral">&quot;The backend_tag is not valid, perhaps it needs to be enabled in the build system&quot;</span>);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classheffte_1_1fft3d__r2c.html">fft3d_r2c&lt;backend_tag, index&gt;</a>(inbox, outbox, r2c_direction, comm, options);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;}</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;}</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html">heffte::fft3d_r2c</a></div><div class="ttdoc">Similar to heffte::fft3d, but computed fewer redundant coefficients when the input is real.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:46</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_a0e288866564e7d12287ec95695aeacec"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#a0e288866564e7d12287ec95695aeacec">heffte::fft3d_r2c::real_buffer_container</a></div><div class="ttdeci">buffer_container&lt; typename define_standard_type&lt; T &gt;::type::value_type &gt; real_buffer_container</div><div class="ttdoc">Container of real values corresponding to the complex type T.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:62</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_a14f987b10e60be6d65cb875b711065b6"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#a14f987b10e60be6d65cb875b711065b6">heffte::fft3d_r2c::fft3d_r2c</a></div><div class="ttdeci">fft3d_r2c(int il0, int il1, int il2, int ih0, int ih1, int ih2, int io0, int io1, int io2, int ol0, int ol1, int ol2, int oh0, int oh1, int oh2, int oo0, int oo1, int oo2, int r2c_direction, MPI_Comm const comm, bool use_reorder, int algorithm, bool use_pencils)</div><div class="ttdoc">Internal use only, used by the Fortran interface.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:96</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_a1dc0b7c454e98b0905e614030f88dcc9"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#a1dc0b7c454e98b0905e614030f88dcc9">heffte::fft3d_r2c::forward</a></div><div class="ttdeci">void forward(input_type const input[], output_type output[], scale scaling=scale::none) const</div><div class="ttdoc">Performs a forward Fourier transform using two arrays.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:147</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_a2e1fefb8e5013f31d48fd9dcdd793bc8"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#a2e1fefb8e5013f31d48fd9dcdd793bc8">heffte::fft3d_r2c::buffer_container</a></div><div class="ttdeci">typename backend::buffer_traits&lt; backend_tag &gt;::template container&lt; T &gt; buffer_container</div><div class="ttdoc">Alias to the container template associated with the backend (allows for RAII memory management).</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:60</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_a3889e71b801a226cc5b2c6a55dce6102"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#a3889e71b801a226cc5b2c6a55dce6102">heffte::fft3d_r2c::size_comm_buffers</a></div><div class="ttdeci">size_t size_comm_buffers() const</div><div class="ttdoc">Returns the size used by the communication workspace buffers (internal use).</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:131</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_a479ce39c4bdb0cd3eae3413f8762be5d"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#a479ce39c4bdb0cd3eae3413f8762be5d">heffte::fft3d_r2c::backward</a></div><div class="ttdeci">void backward(int batch_size, input_type const input[], output_type output[], scale scaling=scale::none) const</div><div class="ttdoc">Overload that performs a batch transform using internally allocated workspace.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:273</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_a502ebe301e32c1c5d899283a41d4cdcc"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#a502ebe301e32c1c5d899283a41d4cdcc">heffte::fft3d_r2c::backend_executor_r2c</a></div><div class="ttdeci">typename one_dim_backend&lt; backend_tag &gt;::executor_r2c backend_executor_r2c</div><div class="ttdoc">FFT executor for the real-to-complex dimension.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:51</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_a62ed62a314613f5ccf8fb05df46af4d7"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#a62ed62a314613f5ccf8fb05df46af4d7">heffte::fft3d_r2c::fft3d_r2c</a></div><div class="ttdeci">fft3d_r2c(typename backend::device_instance&lt; location_tag &gt;::stream_type gpu_stream, box3d&lt; index &gt; const inbox, box3d&lt; index &gt; const outbox, int r2c_direction, MPI_Comm const comm, plan_options const options=default_options&lt; backend_tag &gt;())</div><div class="ttdoc">See the documentation for fft3d::fft3d()</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:85</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_a66b79723f78cf9f1ea5d2b00b217b3f8"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#a66b79723f78cf9f1ea5d2b00b217b3f8">heffte::fft3d_r2c::size_inbox</a></div><div class="ttdeci">long long size_inbox() const</div><div class="ttdoc">Returns the size of the inbox defined in the constructor.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:121</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_a706872c1cfa90729d33198c758b64e36"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#a706872c1cfa90729d33198c758b64e36">heffte::fft3d_r2c::fft3d_r2c</a></div><div class="ttdeci">fft3d_r2c(box3d&lt; index &gt; const inbox, box3d&lt; index &gt; const outbox, int r2c_direction, MPI_Comm const comm, plan_options const options=default_options&lt; backend_tag &gt;())</div><div class="ttdoc">Constructor creating a plan for FFT transform across the given communicator and using the box geometr...</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:76</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_a710727c09ba32ac473cf35397e26c7ed"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#a710727c09ba32ac473cf35397e26c7ed">heffte::fft3d_r2c::location_tag</a></div><div class="ttdeci">typename backend::buffer_traits&lt; backend_tag &gt;::location location_tag</div><div class="ttdoc">Type-tag that is either tag::cpu or tag::gpu to indicate the location of the data.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:55</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_a7d381ece929d12ae10e660951aa039f8"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#a7d381ece929d12ae10e660951aa039f8">heffte::fft3d_r2c::size_outbox</a></div><div class="ttdeci">long long size_outbox() const</div><div class="ttdoc">Returns the size of the outbox defined in the constructor.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:123</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_a803ee1cf1616c08ab5ff2808a18b1314"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#a803ee1cf1616c08ab5ff2808a18b1314">heffte::fft3d_r2c::output_buffer_container</a></div><div class="ttdeci">buffer_container&lt; typename fft_output&lt; T &gt;::type &gt; output_buffer_container</div><div class="ttdoc">Container of the output type corresponding to T, see the table of compatible input and output types.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:64</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_a8f35d3e08a3308f403ce9f7c50118097"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#a8f35d3e08a3308f403ce9f7c50118097">heffte::fft3d_r2c::forward</a></div><div class="ttdeci">void forward(int batch_size, input_type const input[], output_type output[], output_type workspace[], scale scaling=scale::none) const</div><div class="ttdoc">Overload utilizing a batch transform.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:171</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_aa2239b78b2554e12444facc18db15aca"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#aa2239b78b2554e12444facc18db15aca">heffte::fft3d_r2c::backward</a></div><div class="ttdeci">real_buffer_container&lt; scalar_type &gt; backward(buffer_container&lt; scalar_type &gt; const &amp;input, scale scaling=scale::none)</div><div class="ttdoc">Variant of backward() that uses buffer_container for RAII style of resource management.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:286</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_aa6010dba665d7a36aabb015b4048dd79"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#aa6010dba665d7a36aabb015b4048dd79">heffte::fft3d_r2c::fft3d_r2c</a></div><div class="ttdeci">fft3d_r2c(int il0, int il1, int il2, int ih0, int ih1, int ih2, int ol0, int ol1, int ol2, int oh0, int oh1, int oh2, int r2c_direction, MPI_Comm const comm)</div><div class="ttdoc">Internal use only, used by the Fortran interface.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:114</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_aac0bbd227f1caf1e15c9c30b0873b463"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#aac0bbd227f1caf1e15c9c30b0873b463">heffte::fft3d_r2c::backward</a></div><div class="ttdeci">void backward(int batch_size, input_type const input[], output_type output[], input_type workspace[], scale scaling=scale::none) const</div><div class="ttdoc">Overload that performs a batch transform.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:259</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_aacdb9a0139472559916612be1a706456"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#aacdb9a0139472559916612be1a706456">heffte::fft3d_r2c::inbox</a></div><div class="ttdeci">box3d&lt; index &gt; inbox() const</div><div class="ttdoc">Returns the inbox.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:125</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_ac42aa3f5477ba6ff92fe21cc174aa4a8"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#ac42aa3f5477ba6ff92fe21cc174aa4a8">heffte::fft3d_r2c::outbox</a></div><div class="ttdeci">box3d&lt; index &gt; outbox() const</div><div class="ttdoc">Returns the outbox.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:127</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_ac5645b0d98a5ede0971e012ea5ffbb6e"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#ac5645b0d98a5ede0971e012ea5ffbb6e">heffte::fft3d_r2c::backend_executor_c2c</a></div><div class="ttdeci">typename one_dim_backend&lt; backend_tag &gt;::executor backend_executor_c2c</div><div class="ttdoc">FFT executor for the complex-to-complex dimensions.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:49</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_add193030468b3c59c90cad8d628c5877"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#add193030468b3c59c90cad8d628c5877">heffte::fft3d_r2c::forward</a></div><div class="ttdeci">void forward(input_type const input[], output_type output[], output_type workspace[], scale scaling=scale::none) const</div><div class="ttdoc">Overload utilizing a user provided buffer.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:158</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_addbfb7d7962acad1c0e66faefdb68381"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#addbfb7d7962acad1c0e66faefdb68381">heffte::fft3d_r2c::size_workspace</a></div><div class="ttdeci">size_t size_workspace() const</div><div class="ttdoc">Returns the workspace size that will be used, size is measured in complex numbers.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:129</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_adf785e117680189b229963adc3435ddf"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#adf785e117680189b229963adc3435ddf">heffte::fft3d_r2c::fft3d_r2c</a></div><div class="ttdeci">fft3d_r2c(int il0, int il1, int il2, int ih0, int ih1, int ih2, int io0, int io1, int io2, int ol0, int ol1, int ol2, int oh0, int oh1, int oh2, int oo0, int oo1, int oo2, int r2c_direction, MPI_Comm const comm)</div><div class="ttdoc">Internal use only, used by the Fortran interface.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:106</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_ae704581dc4be2201f2784234ffc2132b"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#ae704581dc4be2201f2784234ffc2132b">heffte::fft3d_r2c::backward</a></div><div class="ttdeci">void backward(input_type const input[], output_type output[], input_type workspace[], scale scaling=scale::none) const</div><div class="ttdoc">Overload utilizing a user provided buffer.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:246</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_ae8050aa1c744d3e14220ae49bc685584"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#ae8050aa1c744d3e14220ae49bc685584">heffte::fft3d_r2c::forward</a></div><div class="ttdeci">void forward(int batch_size, input_type const input[], output_type output[], scale scaling=scale::none) const</div><div class="ttdoc">Overload utilizing a batch transform using internally allocated workspace.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:185</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_af04c79cb99789e7a28d7e9bd919f705d"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#af04c79cb99789e7a28d7e9bd919f705d">heffte::fft3d_r2c::get_scale_factor</a></div><div class="ttdeci">double get_scale_factor(scale scaling) const</div><div class="ttdoc">Returns the scale factor for the given scaling.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:297</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_af2672f0565fbebf17526a269efd7809f"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#af2672f0565fbebf17526a269efd7809f">heffte::fft3d_r2c::forward</a></div><div class="ttdeci">output_buffer_container&lt; input_type &gt; forward(buffer_container&lt; input_type &gt; const &amp;input, scale scaling=scale::none)</div><div class="ttdoc">Vector variant of forward() using input and output buffer_container classes.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:211</div></div>
<div class="ttc" id="aclassheffte_1_1fft3d__r2c_html_af655d4b64740b94c27d57c396198a0da"><div class="ttname"><a href="classheffte_1_1fft3d__r2c.html#af655d4b64740b94c27d57c396198a0da">heffte::fft3d_r2c::backward</a></div><div class="ttdeci">void backward(input_type const input[], output_type output[], scale scaling=scale::none) const</div><div class="ttdoc">Performs a backward Fourier transform using two arrays.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:235</div></div>
<div class="ttc" id="agroup__fft3d_html_ga4c9d07a6600d0e32939ec064c0604767"><div class="ttname"><a href="group__fft3d.html#ga4c9d07a6600d0e32939ec064c0604767">heffte::reshape_algorithm</a></div><div class="ttdeci">reshape_algorithm</div><div class="ttdoc">Defines list of potential communication algorithms.</div><div class="ttdef"><b>Definition:</b> heffte_plan_logic.h:48</div></div>
<div class="ttc" id="agroup__fft3d_html_ga8c2c4b54da75fafbe68b3115d4390a66"><div class="ttname"><a href="group__fft3d.html#ga8c2c4b54da75fafbe68b3115d4390a66">heffte::set_options</a></div><div class="ttdeci">plan_options set_options(plan_options opts)</div><div class="ttdoc">Adjusts the user provided options to what can be handled by the backend.</div><div class="ttdef"><b>Definition:</b> heffte_plan_logic.h:207</div></div>
<div class="ttc" id="agroup__fft3d_html_gadb4e1668dd7bca515ed42c91d1846dd7"><div class="ttname"><a href="group__fft3d.html#gadb4e1668dd7bca515ed42c91d1846dd7">heffte::make_fft3d_r2c</a></div><div class="ttdeci">fft3d_r2c&lt; backend_tag, index &gt; make_fft3d_r2c(box3d&lt; index &gt; const inbox, box3d&lt; index &gt; const outbox, int r2c_direction, MPI_Comm const comm, plan_options const options=default_options&lt; backend_tag &gt;())</div><div class="ttdoc">Factory method that auto-detects the index type based on the box.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d_r2c.h:394</div></div>
<div class="ttc" id="agroup__fft3d_html_gae0a0922e2be72d5af2c9faad038874cb"><div class="ttname"><a href="group__fft3d.html#gae0a0922e2be72d5af2c9faad038874cb">heffte::scale</a></div><div class="ttdeci">scale</div><div class="ttdoc">Indicates the scaling factor to apply on the result of an FFT operation.</div><div class="ttdef"><b>Definition:</b> heffte_fft3d.h:113</div></div>
<div class="ttc" id="agroup__fft3d_html_ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8"><div class="ttname"><a href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cba334c4a4c42fdb79d7ebc3e73b517e6f8">heffte::scale::none</a></div><div class="ttdeci">@ none</div><div class="ttdoc">No scale, leave the result unperturbed similar to the FFTW API.</div></div>
<div class="ttc" id="agroup__fft3d_html_ggae0a0922e2be72d5af2c9faad038874cbafeca3c730601be7fd57f1f0b668b4637"><div class="ttname"><a href="group__fft3d.html#ggae0a0922e2be72d5af2c9faad038874cbafeca3c730601be7fd57f1f0b668b4637">heffte::scale::symmetric</a></div><div class="ttdeci">@ symmetric</div><div class="ttdoc">Symmetric scaling, apply the square-root of the full scaling.</div></div>
<div class="ttc" id="agroup__fft3dbackend_html_ga65d6597fd795ca487089c90a6052afab"><div class="ttname"><a href="group__fft3dbackend.html#ga65d6597fd795ca487089c90a6052afab">heffte::backend::name</a></div><div class="ttdeci">std::string name()</div><div class="ttdoc">Returns the human readable name of the backend.</div><div class="ttdef"><b>Definition:</b> heffte_common.h:240</div></div>
<div class="ttc" id="agroup__fft3dmisc_html_ga2738b0dcfd330cf26181036ee5133a09"><div class="ttname"><a href="group__fft3dmisc.html#ga2738b0dcfd330cf26181036ee5133a09">heffte::direction</a></div><div class="ttdeci">direction</div><div class="ttdoc">Indicates the direction of the FFT (internal use only).</div><div class="ttdef"><b>Definition:</b> heffte_common.h:535</div></div>
<div class="ttc" id="agroup__fft3dmisc_html_ga45476ceb85f91090541c53ac322b06b2"><div class="ttname"><a href="group__fft3dmisc.html#ga45476ceb85f91090541c53ac322b06b2">heffte::get_max_box_size_r2c</a></div><div class="ttdeci">size_t get_max_box_size_r2c(std::array&lt; some_class, 3 &gt; const &amp;executors)</div><div class="ttdoc">Returns the max of the box_size() for each of the executors.</div><div class="ttdef"><b>Definition:</b> heffte_utils.h:413</div></div>
<div class="ttc" id="agroup__fft3dmisc_html_gaf5806a52f52a1dd1b316d52e742b187c"><div class="ttname"><a href="group__fft3dmisc.html#gaf5806a52f52a1dd1b316d52e742b187c">heffte::get_max_work_size</a></div><div class="ttdeci">size_t get_max_work_size(std::array&lt; some_class, 3 &gt; const &amp;executors)</div><div class="ttdoc">Returns the max of the workspace_size() for each of the executors.</div><div class="ttdef"><b>Definition:</b> heffte_utils.h:423</div></div>
<div class="ttc" id="agroup__fft3dmisc_html_gga2738b0dcfd330cf26181036ee5133a09a195fe59b6f103787a914aead0f3db502"><div class="ttname"><a href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a195fe59b6f103787a914aead0f3db502">heffte::direction::backward</a></div><div class="ttdeci">@ backward</div><div class="ttdoc">Inverse DFT transform.</div></div>
<div class="ttc" id="agroup__fft3dmisc_html_gga2738b0dcfd330cf26181036ee5133a09a965dbaac085fc891bfbbd4f9d145bbc8"><div class="ttname"><a href="group__fft3dmisc.html#gga2738b0dcfd330cf26181036ee5133a09a965dbaac085fc891bfbbd4f9d145bbc8">heffte::direction::forward</a></div><div class="ttdeci">@ forward</div><div class="ttdoc">Forward DFT transform.</div></div>
<div class="ttc" id="agroup__fft3dplan_html_gadfe5ddda96e7aecb88edc7aeb07dbc91"><div class="ttname"><a href="group__fft3dplan.html#gadfe5ddda96e7aecb88edc7aeb07dbc91">heffte::plan_operations</a></div><div class="ttdeci">logic_plan3d&lt; index &gt; plan_operations(ioboxes&lt; index &gt; const &amp;boxes, int r2c_direction, plan_options const options, int const mpi_rank)</div><div class="ttdoc">Creates the logic plan with the provided user input.</div><div class="ttdef"><b>Definition:</b> heffte_plan_logic.cpp:421</div></div>
<div class="ttc" id="agroup__hefftecuda_html_ga2b39bc4364fc371a804e17238b7ac566"><div class="ttname"><a href="group__hefftecuda.html#ga2b39bc4364fc371a804e17238b7ac566">heffte::data_scaling::apply</a></div><div class="ttdeci">void apply(cudaStream_t stream, index num_entries, scalar_type *data, double scale_factor)</div><div class="ttdoc">Simply multiply the num_entries in the data by the scale_factor.</div><div class="ttdef"><b>Definition:</b> heffte_backend_cuda.h:796</div></div>
<div class="ttc" id="agroup__hefftempi_html_ga5df7514ec8acb2b7bcc642892ed22f67"><div class="ttname"><a href="group__hefftempi.html#ga5df7514ec8acb2b7bcc642892ed22f67">heffte::mpi::comm_rank</a></div><div class="ttdeci">int comm_rank(MPI_Comm const comm)</div><div class="ttdoc">Returns the rank of this process within the specified comm.</div><div class="ttdef"><b>Definition:</b> heffte_utils.h:78</div></div>
<div class="ttc" id="agroup__hefftempi_html_gacade914d344f3727d9e7d8dcfd13ed5a"><div class="ttname"><a href="group__hefftempi.html#gacade914d344f3727d9e7d8dcfd13ed5a">heffte::mpi::gather_boxes</a></div><div class="ttdeci">ioboxes&lt; index &gt; gather_boxes(box3d&lt; index &gt; const my_inbox, box3d&lt; index &gt; const my_outbox, MPI_Comm const comm)</div><div class="ttdoc">Gather all boxes across all ranks in the comm.</div><div class="ttdef"><b>Definition:</b> heffte_geometry.h:697</div></div>
<div class="ttc" id="agroup__hefftereshape_html_gadd1dabaa0d659f85b6c882c2a14cd895"><div class="ttname"><a href="group__hefftereshape.html#gadd1dabaa0d659f85b6c882c2a14cd895">heffte::get_workspace_size</a></div><div class="ttdeci">size_t get_workspace_size(std::array&lt; std::unique_ptr&lt; reshape3d_base&lt; index &gt;&gt;, 4 &gt; const &amp;shapers)</div><div class="ttdoc">Returns the maximum workspace size used by the shapers.</div><div class="ttdef"><b>Definition:</b> heffte_reshape3d.h:115</div></div>
<div class="ttc" id="anamespaceheffte_html"><div class="ttname"><a href="namespaceheffte.html">heffte</a></div><div class="ttdoc">Namespace containing all HeFFTe methods and classes.</div><div class="ttdef"><b>Definition:</b> heffte_backend_cuda.h:38</div></div>
<div class="ttc" id="anamespaceheffte_html_a13b555103303ed58158f21210a1a3ecd"><div class="ttname"><a href="namespaceheffte.html#a13b555103303ed58158f21210a1a3ecd">heffte::convert_to_standard</a></div><div class="ttdeci">define_standard_type&lt; scalar_type &gt;::type * convert_to_standard(scalar_type input[])</div><div class="ttdoc">Converts an array of some type to an array of the C++ equivalent type.</div><div class="ttdef"><b>Definition:</b> heffte_utils.h:354</div></div>
<div class="ttc" id="astructheffte_1_1backend_1_1buffer__traits_html"><div class="ttname"><a href="structheffte_1_1backend_1_1buffer__traits.html">heffte::backend::buffer_traits</a></div><div class="ttdoc">Defines the container for the temporary buffers.</div><div class="ttdef"><b>Definition:</b> heffte_common.h:212</div></div>
<div class="ttc" id="astructheffte_1_1backend_1_1device__instance_html"><div class="ttname"><a href="structheffte_1_1backend_1_1device__instance.html">heffte::backend::device_instance</a></div><div class="ttdoc">Holds the auxiliary variables needed by each backend.</div><div class="ttdef"><b>Definition:</b> heffte_common.h:358</div></div>
<div class="ttc" id="astructheffte_1_1backend_1_1device__instance_html_a2b63f0b1deb23636cee0bfc94ffb564c"><div class="ttname"><a href="structheffte_1_1backend_1_1device__instance.html#a2b63f0b1deb23636cee0bfc94ffb564c">heffte::backend::device_instance::stream_type</a></div><div class="ttdeci">void * stream_type</div><div class="ttdoc">The type for the internal stream, the cpu uses just a void pointer.</div><div class="ttdef"><b>Definition:</b> heffte_common.h:370</div></div>
<div class="ttc" id="astructheffte_1_1backend_1_1device__instance_html_a50b2c89b7100872ab6c704d3e4fb375e"><div class="ttname"><a href="structheffte_1_1backend_1_1device__instance.html#a50b2c89b7100872ab6c704d3e4fb375e">heffte::backend::device_instance&lt; backend::buffer_traits&lt; backend_tag &gt;::location &gt;::stream</a></div><div class="ttdeci">void * stream()</div><div class="ttdoc">Returns the nullptr.</div><div class="ttdef"><b>Definition:</b> heffte_common.h:364</div></div>
<div class="ttc" id="astructheffte_1_1backend_1_1device__instance_html_a641aa853208673ca6458c1f9cfecc01c"><div class="ttname"><a href="structheffte_1_1backend_1_1device__instance.html#a641aa853208673ca6458c1f9cfecc01c">heffte::backend::device_instance&lt; backend::buffer_traits&lt; backend_tag &gt;::location &gt;::device_instance</a></div><div class="ttdeci">device_instance(void *=nullptr)</div><div class="ttdoc">Empty constructor.</div><div class="ttdef"><b>Definition:</b> heffte_common.h:360</div></div>
<div class="ttc" id="astructheffte_1_1backend_1_1is__enabled_html"><div class="ttname"><a href="structheffte_1_1backend_1_1is__enabled.html">heffte::backend::is_enabled</a></div><div class="ttdoc">Allows to define whether a specific backend interface has been enabled.</div><div class="ttdef"><b>Definition:</b> heffte_common.h:201</div></div>
<div class="ttc" id="astructheffte_1_1box3d_html"><div class="ttname"><a href="structheffte_1_1box3d.html">heffte::box3d</a></div><div class="ttdoc">A generic container that describes a 3d box of indexes.</div><div class="ttdef"><b>Definition:</b> heffte_geometry.h:67</div></div>
<div class="ttc" id="astructheffte_1_1is__ccomplex_html"><div class="ttname"><a href="structheffte_1_1is__ccomplex.html">heffte::is_ccomplex</a></div><div class="ttdoc">Struct to specialize to allow HeFFTe to recognize custom single precision complex types.</div><div class="ttdef"><b>Definition:</b> heffte_utils.h:251</div></div>
<div class="ttc" id="astructheffte_1_1is__zcomplex_html"><div class="ttname"><a href="structheffte_1_1is__zcomplex.html">heffte::is_zcomplex</a></div><div class="ttdoc">Struct to specialize to allow HeFFTe to recognize custom double precision complex types.</div><div class="ttdef"><b>Definition:</b> heffte_utils.h:269</div></div>
<div class="ttc" id="astructheffte_1_1logic__plan3d_html"><div class="ttname"><a href="structheffte_1_1logic__plan3d.html">heffte::logic_plan3d</a></div><div class="ttdoc">The logic plan incorporates the order and types of operations in a transform.</div><div class="ttdef"><b>Definition:</b> heffte_plan_logic.h:275</div></div>
<div class="ttc" id="astructheffte_1_1one__dim__backend_html"><div class="ttname"><a href="structheffte_1_1one__dim__backend.html">heffte::one_dim_backend</a></div><div class="ttdoc">Indicates the structure that will be used by the fft backend.</div><div class="ttdef"><b>Definition:</b> heffte_common.h:546</div></div>
<div class="ttc" id="astructheffte_1_1plan__options_html"><div class="ttname"><a href="structheffte_1_1plan__options.html">heffte::plan_options</a></div><div class="ttdoc">Defines a set of tweaks and options to use in the plan generation.</div><div class="ttdef"><b>Definition:</b> heffte_plan_logic.h:131</div></div>
<div class="ttc" id="astructheffte_1_1tag_1_1cpu_html"><div class="ttname"><a href="structheffte_1_1tag_1_1cpu.html">heffte::tag::cpu</a></div><div class="ttdoc">Indicates the use of cpu backend and that all input/output data and arrays will be bound to the cpu.</div><div class="ttdef"><b>Definition:</b> heffte_common.h:38</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><b>heffte_fft3d_r2c.h</b></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
